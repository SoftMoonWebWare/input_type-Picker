<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name='description' content='SoftMoon-WebWare’s JavaScript™ powered input type="picker" HTML extension.'>
<meta name='author' content='Joe Golembieski, SoftMoon-WebWare'>
<meta name='copyright' content='Copyright © 2010, 2012, 2013, 2014, 2015, 2022 Joe Golembieski, SoftMoon-WebWare'>
<title>&lt;input type="picker"&gt; from SoftMoon-WebWare</title>
<link rel="icon" type="image/x-icon" href="images/SoftMoonWebWare.gif">
<script>const SoftMoon={};  Object.defineProperty(SoftMoon, 'WebWare', {value: {}, enumerable: true});</script>
<script type='text/javascript' src='JS_toolbucket/+++JS/+++.js'></script>
<script type='text/javascript' src='JS_toolbucket/SoftMoon-WebWare/UniDOM-2022.js'></script>
<script type='text/javascript' src='JS_toolbucket/SoftMoon-WebWare/Picker.js'></script>
<style type="text/css">
body, header, main, section, footer, figure, div, h1, h2, h4, h5, img, ul, ol, dl, menu, li {
	margin: 0;
	padding: 0; }
body {
	min-width: 62.618em;
	font-family: serif;
	color: #000000;
	background-color: #FFDEAD;
	background-image:  /* SteelBlue */
		linear-gradient(to right, #4682B4FF, 304px, #4682B400 800px),
		linear-gradient(to bottom, #4682B4FF, 266px, #4682B400 700px),
		linear-gradient(to top, #4682B4FF, 38px, #4682B400 100px);
	}
mark {
	color: inherit;
	background-color: inherit; }

header h1 {
	font-size: 1.618em;
	font-weight: bold;
	clear: both;
	text-align: center;  }
header h1:first-child {
	font-family: sans-serif;
	padding: .618em 1em 0 1em;
	text-align: left; }
header h1 span {
	padding: 0 0 0 2.618em;
	font-size: .764em }  /* ≈ Φ + ((1-Φ) - (1-Φ)*Φ) */

header figure {
	margin-left: .382rem;
	float: left; }
#logo {
	opacity: .78;
	font-size: 1.618em; /*for alt text*/
	font-weight: bold;
	line-height: 150%; }
header figcaption {
	font-size: 1.382em;
	font-weight: bold;
	text-align: center;
	width: 27em; }
header h1 span,
header figcaption span {
	display: block;
	font-style: oblique; }

main {
	text-align: center; }
main > p {
	text-align: justify;
	text-indent: -.618em;
	font-size: 1.236em;
	width: 27em;
	margin: 0 auto 0 auto;
	padding: 0 1em 1em 1em; }
main > p * {
	text-indent: 0; }
main > p:first-letter {
	font-size: 1.618em;
	font-weight: bold;
	color: #000040; }


main samp, code {
	white-space: nowrap;
	text-align: left;
	font-size: .854076em;
	font-family: "Consolas"; }
p code {
  display: inline-block; }
p code.block {
	white-space: pre; }
main > code, main > samp {
	display: block;
	white-space: pre;
	background-color: white;
	width: 98%;
	margin: 0 auto;
	padding: .382em;
	overflow: auto; }
.filename {
  color: #0066FF;
	white-space: nowrap; }
h3 {
	margin: .618em 0 0 0;
	padding: 0; }
label {
	display: inline-block;
	position: relative;
	margin-bottom: 4em; }
label .pickerPanel {
  position: absolute;
	top: 1.618em;
	right: -10.618em; }
.pickerPanel,
#songs .picker {display: none;}
.activePicker,
#songs .activePicker {display: table;}
#songs {
	padding: 2em 0 .618em 0;
	margin: .618em 12.618em;
	position: relative; }
#songPickerControls.activePicker {
	position: absolute;
	top: 1em;
	left: 0;
	display: block;
	width: 100%;
	text-align: center;
	background-color: yellow; }
@-moz-document url-prefix() {
	#songPickerControls.activePicker {
		top: 0.25em;  /* value for Firefox - they need to fix this issue - going on 10+ years! */
	}
}
#songs label {
	margin: 0 .618em; }
#songPickerHTML {
	background-color: yellow;
	border: 2px solid blue; }
#songPickerHTML td {
	padding: 0 .618em;
	border: 1px solid;
	white-space: nowrap; }
#songPickerHTML td:last-child {
	font-style: oblique; }

dl {
	max-width: 34em;
	text-align: left;
	margin: 0 auto 1em;
}

footer p {
	margin: 0 1.618em;
	font-size: .78em;
	font-weight: bold; }
footer note {
	margin-right: 2.618em; }
footer note:last-child {
	margin-right: 0; }

abbr[tm] {
	font-size: .763924em;
	vertical-align: .236076em;
	line-height: 100%; }
kbd span {
	display: inline-block;
	position: static;
	border: 1px solid #8080FF;
	border-bottom: 2px solid #404080;
	border-right: 2px solid #404080;
	border-radius: 1.618em / 2em;
	color: white;
	background-color: #202040;
	text-align: center;
	margin: 0 .382em;
	padding: 0 .618em;  }
nobr {
	white-space: nowrap; }
a[target]::before {
	content: '►'; }
blockcaption {
	display: block;
	margin: 0.618em 1.618em 0 1.618em;
	padding: 0;
	font-size: 1.168em;
}
</style>
</head>
<body>
<header>
<h1>Custom Web Software Development</h1>
<figure>
<img id='logo' src="images/SoftMoon-WebWare.gif" alt="SoftMoon-WebWare">
<figcaption>JavaScript<abbr tm>™</abbr>, <abbr>HTML 5</abbr>, <abbr>CSS 4</abbr>, &amp; <abbr>PHP 8</abbr>:
<span>Innovative Enterprise level Scripting for interactive sites, <acronym title='software as a service'>SaaS</acronym>, &amp; cross-platform desktop apps</span></figcaption>
</figure>
<h1>JavaScript<abbr tm>™</abbr> powered <code>&lt;input type="picker"&gt;</code></h1>
</header>

<main id='content'>
<p><abbr>HTML</abbr> forms are an essential part of interacting with web-page viewers,
and the <code>&lt;input&gt;</code> tag is the most common interface tool used.&nbsp;
However, it gives little help to users that need to enter complex and/or specific data.&nbsp;
<abbr>HTML5</abbr> introduces the <code>&lt;datalist&gt;</code> element which can turn an
<code>&lt;input&gt;</code> tag into a hybrid with a <code>&lt;select&gt;</code> tag,
giving the user a pull-down menu to choose from without limiting the input data to only the menu items.&nbsp;
But sometimes that’s not enough…you want to present to your users
a complex table of data to choose from, or maybe some other source needs to generate the data on-the-fly,
such as a color-picker (like the MasterColorPicker project, for which this project was developed).&nbsp;
So here I present the <code>&lt;input type="picker"&gt;</code> project.&nbsp;
If an <code>&lt;input type="text"&gt;</code> tag is like a car,
and a <code>&lt;textarea&gt;</code> tag is like a pickup truck,
and a <code>&lt;select&gt;</code> tag is like a bus,
and an <code>&lt;input type="text"&gt;</code> with a <code>&lt;datalist&gt;</code> is like a train,
then an <code>&lt;input&gt;</code> with a <code>Picker</code> interface is like an multi-city intergalactic spacecraft.</p>

<p>When the <code>Picker</code> interface code was first developed,
Microsoft’s Internet Exploder 6 was king and <abbr>HTML</abbr> was still in its adolescence.&nbsp;
This concept of a “picker” was fairly new back then;
these days the concept is fully embraced and supported by native <abbr>HTML</abbr> logistics.&nbsp;
The <code>Picker</code> class now also supports this newer technology and easily integrates with it.&nbsp;
Specifically, <abbr title='Accessible Rich Internet Applications'>ARIA</abbr>
<a href='https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles/combobox_role' target="Mozilla">“combobox”</a> and
<a href='https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-haspopup' target="Mozilla">“popup”</a>
specifications are incorporated into the <code>Picker</code>’s framework.&nbsp;
For picker pop-ups of role-type “dialog,” <a href='#tab_key'>integrated <kbd><span>Tab</span></kbd> key</a> support is also incorporated.&nbsp;
You can download the JavaScript<mark class='macronym'>™</mark> package from our ►<a href='OpenSource.php'>download page</a>
or Git it from GitHub: <a href='https://github.com/SoftMoonWebWare/input_type_Picker' target='github'>input_type_Picker</a>.</p>
</p>

<p>Using the <code>Picker</code> Class with an <code>&lt;input type="text"&gt;</code> is simple.&nbsp;
Just as you would do using the <code>&lt;datalist&gt;</code> tag, the “picker” <abbr>HTML</abbr>
is separate from the <code>&lt;input&gt;</code> tag itself.&nbsp;
However, <code>&lt;datalist&gt;</code>s are simple “lists”, and you may only associate one <code>&lt;datalist&gt;</code>
with each <code>&lt;input&gt;</code>.&nbsp;
With the <code>Picker</code> Class you may associate any number of “panels” (<abbr>HTML</abbr> elements),
and each panel may have any number of “pickers” along with any other <abbr>HTML</abbr> markup
and auxiliary displays and data, as well as <a href='#interface_controls'>“interface controls”</a> – form controls
(such as <code>&lt;input&gt;</code>s and <code>&lt;select&gt;</code>s)
that modify the “pickers” themselves and/or their behaviors.&nbsp;
Furthermore, not only may you associate multiple “panels” and “pickers” with an <code>&lt;input&gt;</code>,
you may associate multiple <code>&lt;input&gt;</code>s with the same “panel”(s)/“picker”(s).&nbsp;
For instance, the <a href="MasterColorPicker_instructions.php">MasterColorPicker</a> project uses
9 “panels” and 19 “pickers” by default (at this time of writing),
and the <a href="RainbowMaker%202.0/">Rainbow-Maker 2</a> project
associates the MasterColorPicker with many different <code>&lt;input&gt;</code>s.</p>

<p>“Panels” and their “pickers” receive JavaScript<abbr tm>™</abbr>-applied <abbr>CSS</abbr> class-names when “active”,
allowing the developer to pop-up and pop-out the picker <abbr>HTML</abbr> if desired
(as noted <abbr>ARIA</abbr>-support is included for pop-ups also),
or style it any way needed for complete flexibility.&nbsp;
“Panels” may be styled any way you choose using your custom <abbr>CSS</abbr>,
and if you have more than one panel, they may visually overlap on the display;&nbsp;
the <code>Picker</code> Class manages an additional set of class-names which allows you to manage the
Z-index level of each panel, so the last one clicked on may be “brought to the top.”&nbsp;
The target <code>&lt;input&gt;</code> (or <code>&lt;textarea&gt;</code>, etc., but for simplicity we will just refer to inputs)
has its <abbr>ARIA</abbr> attributes modified in real-time to reflect this “pop-up” state of the picker’s panels.&nbsp;
The target <code>&lt;input&gt;</code> also needs to be kept in focus when you click on the Picker Interface “panel(s).”&nbsp;
Additionally, “panels” and “pickers” may be assigned user-defined event-handlers which are triggered
when they become “active” or “inactive” (<code>onPickerStateChange</code> and <code>onInterfaceStateChange</code>).&nbsp;
All this is managed by the Picker Class by a complex interaction − a dance − of event-handlers.&nbsp;
This is its primary function in life.&nbsp;
It would be easy to have a JavaScript function that
simply adds/replaces an <code>&lt;input&gt;</code>’s <code>value</code> with anything when you click on whatever…&nbsp;
And it’s easy to keep up with which <code>&lt;input&gt;</code> is the one of many
of which to replace the old value with a new value.&nbsp;
The trick is keeping up with when an <code>&lt;input&gt;</code> is “active”, especially when Picker-interfaces
need to scroll or if they need to use another <abbr>HTML</abbr> element that requires keyboard “focus.”&nbsp;
Generally, when an <code>&lt;input&gt;</code> is associated with a Picker-interface,
the <code>&lt;input&gt;</code> and Picker are considered “active” when the <code>&lt;input&gt;</code> has “focus.”&nbsp;
If your interface itself needs to have an <abbr>HTML</abbr> element that requires keyboard “focus”,
including other <code>&lt;input type='text'&gt;</code>s,
<code>&lt;input type='file'&gt;</code>s, <code>&lt;input type='number'&gt;</code>s,
<code>&lt;textarea&gt;</code>s, <code>&lt;select&gt;</code>s, etc.,
then they need to be “registered.”&nbsp;
The <code>Picker</code> Class gives you all you need to manage all the event-handlers required to maintain the “focus”
of the target <code>&lt;input&gt;</code> associated with a Picker-interface when necessary, and to keep track of
when the Picker-interface is “active”, and when it is not.&nbsp;
The comments in the code file explain all this.&nbsp;
</p>

<p>But wait!&nbsp;
You don’t even need to use an <code>&lt;input type='text'&gt;</code> with the <code>Picker</code> Class
as the <code>dataTarget</code> (the object that receives the data picked by the end-user).&nbsp;
<abbr>HTML</abbr> <code>&lt;textarea&gt;</code>s, <code>&lt;select&gt;</code>s,
<code>&lt;input type='text' list='<var>datalistID</var>'&gt;</code>s,
and even document text-nodes are automatically recognized by the <code><var>Picker_instance</var>.pick()</code> method.&nbsp;
By default, the <code><var>Picker_instance</var>.dataTarget</code> receives the data-value picked by the end user.&nbsp;
If no <code>dataTarget</code> is set then the <code><var>Picker_instance</var>.masterTarget</code> is used, if any.&nbsp;
The <code>dataTarget</code> and <code>masterTarget</code> each may be any
JavaScript<abbr tm>™</abbr> Object.&nbsp;
Or they may be <code>&lt;input type='hidden'&gt;</code> if you don't care to show the user the picked value,
but want to send the value back to the server with a form-submittal.&nbsp;
To supplement this functionality, add a JavaScript<abbr tm>™</abbr> function to the
Array of <code><var>Picker_instance</var>.pickFilters</code>.&nbsp;
To replace this functionality, replace the <code><var>Picker_instance</var>.pick</code> method with your own function.</p>

<p>There is a plethora of comments embedded in the <code>Picker</code> JavaScript<abbr tm>™</abbr> code
which you should read if you want to use this package.&nbsp;
Beyond that, as usual a simple example does best to explain the usage of the <code>Picker</code> Class Object.&nbsp;
Below you will see the code for a simple <abbr>HTML</abbr> <code>Picker</code> example and the working demo
of this example code.&nbsp;
<!-- If you open your browser’s JavaScript<abbr tm>™</abbr> console,
you can see the “flow” of events as they happen.&nbsp;  -->
The MasterColorPicker<span class='footmark'>™</span> project is a more complex example of
using the <code>Picker</code> package.&nbsp;
If you study the <span class='filename'>MasterColorPicker2.js</span> file, you will see the
<code>Color_Picker</code> Class (found near the beginning of that file)
acts as an intermediary between the color-pickers and the <code>Picker</code> Class.&nbsp;
At the end of each color-picker’s code section you will see the event-handlers attached to each color-picker,
and how they interact with the <code>Color_Picker</code> class to “pick” colors;&nbsp;
and the YinYang NíHóng<span class='footmark'>™</span> Color Picker code shows an advanced example of
using the <code>onPickerStateChange</code> event.&nbsp;
At the end of the <span class='filename'>MasterColorPicker2.js</span> file you will see how the
<code>MasterColorPicker</code> Object (which is used by the <code>Color_Picker</code> Class)
is created from an instance of the <code>Picker</code> Class,
an example of how the <code>pickFilter</code> works, and another example of using the <code>onPickerStateChange</code> event.</p>

<h3>Implementing the <code>Picker</code> class</h3>
<p>The <code>Picker</code> class code resides in the <code>SoftMoon.WebWare</code> namespace
to avoid conflict with other software packages.&nbsp;
Back in the day, the code file could create this namespace on-the-fly if need be;
then along came the <code>const</code> type of “JavaScript<footnote>™</footnote> variable”.&nbsp;
The code file can not check for the existance of the namespace and then create it
if <code>SoftMoon</code> is a constant, and in the SoftMoon-WebWare world’s codebase, it now is.&nbsp;
So <strong>you</strong> must first create this namespace:
<code class='block'>&lt;script&gt;const SoftMoon;
Object.defineProperty(SoftMoon, "WebWare", {value:{}, enumerable:true});&lt;script&gt;</code>
and then load the files:
<code>&lt;script scr='JS_toolbucket/+++JS/+++.js'&gt;&lt;/script&gt;</code>
<code>&lt;script scr='JS_toolbucket/SoftMoon-WebWare/UniDOM-2022.js'&gt;&lt;/script&gt;</code>
<code>&lt;script scr='JS_toolbucket/SoftMoon-WebWare/Picker.js'&gt;&lt;/script&gt;</code></p>

<blockcaption>All these examples below use the following simple <abbr>CSS</abbr>:</blockcaption>
<code>
&#60;style&#62;
label {
  display&#58; inline-block;
  position&#58; relative;
  margin-bottom&#58; 4em; }
label .pickerPanel {
  position&#58; absolute;
  top&#58; 1.1618em;
  right&#58; -10.618em; }
.pickerPanel {display&#58; none;}
.activePicker {display&#58; table;}
&#60;/style&#62;
</code>

<blockcaption>A <em>very</em> simple example:</blockcaption>
<code>
&#60;label&#62;Pick a color &#60;input type='text' id='getColor'&#62;
&#60;table id='colorPicker' role='dialog'&#62;
&#60;caption&#62;Colors&#60;/caption&#62;
&#60;tr&#62;
	&#60;td style='background-color&#58;red'&#62;red&#60;/td&#62;
	&#60;td style='background-color&#58;orange'&#62;orange&#60;/td&#62;
	&#60;td style='background-color&#58;yellow'&#62;yellow&#60;/td&#62;
	&#60;td style='background-color&#58;green'&#62;green&#60;/td&#62;
	&#60;td style='background-color&#58;cyan'&#62;cyan&#60;/td&#62;
	&#60;td style='background-color&#58;blue'&#62;blue&#60;/td&#62;
	&#60;td style='background-color&#58;violet'&#62;violet&#60;/td&#62;
	&#60;td style='background-color&#58;indigo'&#62;indigo&#60;/td&#62;
&#60;/tr&#62;
&#60;/table&#62;&#60;/label&#62;
&#60;script type='text/javascript'&#62;
  // note how you can use the required/included “UniDOM” package to add event handlers, or add them any other way.

UniDOM.addEventHandler(window, 'onload', function() {
  const
    itybitHTML=document.getElementById('colorPicker'),
    itybitColorPicker=new SoftMoon.WebWare.Picker(itybitHTML),  // no options needed
    itybitColorInput=document.getElementById('getColor');
  function selector(event)  {
    if (event.target.tagName==='TD')  itybitColorPicker.pick(event.target.firstChild.data);  }

  UniDOM.addEventHandler(itybitHTML, 'onclick', selector);
  itybitColorPicker.registerTargetElement(itybitColorInput);  });
&#60;/script&#62;
</code>
<label>Pick a color <input type='text' id='getColor'>
<table id='colorPicker' class='picker' role='dialog'>
<caption>Colors</caption>
<tr>
	<td style='background-color:red'>red</td>
	<td style='background-color:orange'>orange</td>
	<td style='background-color:yellow'>yellow</td>
	<td style='background-color:green'>green</td>
	<td style='background-color:cyan'>cyan</td>
	<td style='background-color:blue'>blue</td>
	<td style='background-color:violet'>violet</td>
	<td style='background-color:indigo'>indigo</td>
</tr>
</table></label>
<script type='text/javascript'>
UniDOM.addEventHandler(window, 'onload', function() {
	const
		itybitHTML=document.getElementById('colorPicker'),
		itybitColorPicker=new SoftMoon.WebWare.Picker(itybitHTML),  // no options needed
		itybitColorInput=document.getElementById('getColor');
	function selector(event)  {
		if (event.target.tagName==='TD')  itybitColorPicker.pick(event.target.firstChild.data);  }

	UniDOM.addEventHandler(itybitHTML, 'onclick', selector);
	itybitColorPicker.registerTargetElement(itybitColorInput);  });
</script>
<br>
<blockcaption>Basically the same, but with two different target-inputs, and a relocating Picker.&nbsp;
Note the difference in the way the <code>dataTarget &lt;input&gt;</code>s are registered:</blockcaption>
<code>
&#60;div id='relocatableColorPicker'&#62;
&#60;label&#62;Foreground Color&#58;&#60;input type='text'&#62;&#60;/label&#62;
&#60;label&#62;Background Color&#58;&#60;input type='text'&#62;&#60;/label&#62;
&#60;/div&#62;
&#60;script type='text/javascript'&#62;
UniDOM.addEventHandler(window, 'onload', function() {
  const
    itybitHTML=document.getElementById('colorPicker').cloneNode(true),   // we might instead use “removeNode” but we keep the original because it is used in the previous example.
    itybitColorPicker=new SoftMoon.WebWare.Picker(itybitHTML),  // no options needed
    cInputs=document.querySelectorAll('#relocatableColorPicker input');
  function selector(event)  {
    if (event.target.tagName==='TD')  itybitColorPicker.pick(event.target.firstChild.data);  }

  itybitHTML.id+="2";  //we should make the id unique since we cloned it for HTML syntax, but really it doesn’t affect anything
  UniDOM.addEventHandler(itybitHTML, 'onclick', selector);
  for (const inp of cInputs)  {               // ↓↓ note we pass in the &lt;label&gt; for each input as the containing element for the picker.
    itybitColorPicker.registerTargetElement(inp, inp.parentNode);  }  });
&#60;/script&#62;
</code>
<div id='relocatableColorPicker'>
<label>Foreground Color:<input type='text'></label>
<label>Background Color:<input type='text'></label>
</div>
<script type='text/javascript'>
UniDOM.addEventHandler(window, 'onload', function() {
	const
		itybitHTML=document.getElementById('colorPicker').cloneNode(true),   // we might instead use “removeNode” but we keep the original because it is used in the previous example.
		itybitColorPicker=new SoftMoon.WebWare.Picker(itybitHTML),  // no options needed
		cInputs=document.querySelectorAll('#relocatableColorPicker input');
	function selector(event)  {
		if (event.target.tagName==='TD')  itybitColorPicker.pick(event.target.firstChild.data);  }

	itybitHTML.id+="2";  //we should make the id unique since we cloned it for HTML syntax, but really it doesn’t affect anything
	UniDOM.addEventHandler(itybitHTML, 'onclick', selector);
	for (const inp of cInputs)  {               // ↓↓ note we pass in the <label> for each input as the containing element for the picker.
		itybitColorPicker.registerTargetElement(inp, inp.parentNode);  }  });
</script>

<h3>Picker “types”</h3>
<p>With the newer <abbr>HTML5</abbr> spec and the <abbr>ARIA</abbr> support specs that go along,
there are 5 “types” of picker-interfaces:
<nobr><code>menu</code>,</nobr> <nobr><code>list</code>,</nobr> <nobr><code>tree</code>,</nobr> <nobr><code>grid</code>,</nobr> and <code>dialog</code>.&nbsp;
The “dialog” type indicates a complex interface, which the <code>Picker</code> class was designed for,
including <a href='#multipanel'>multiple panels</a>, <a href='#interface_controls'>interface controls</a>,
and <a href='#tab_key'><kbd><span>Tab</span></kbd> key control</a>.&nbsp;
But <code>Picker</code>s may also embrace the other “types” which by definition
do not typically embrace multiple panels or interface controls,
and therefore also have no need for tab-key-control.&nbsp;
<a href='https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-haspopup' target="Mozilla"><abbr>ARIA</abbr> “popup” specs</a>
indicate that these other picker-types use a different set of keyboard keys
to navigate the “pop-up options” (the arrow keys
<nobr>(<kbd><span>↑</span></kbd></nobr> <kbd><span>↓</span></kbd> <kbd><span>←</span></kbd> <nobr><kbd><span>→</span></kbd>)</nobr> and others),
and specifically <strong><em>not</em></strong> the <kbd><span>Tab</span></kbd> key that the <code>Picker</code> class uses
to navigate though <a href='#interface_controls'>“interface controls”</a>.&nbsp;
If you implement a picker of type <nobr><code>menu</code>,</nobr> <nobr><code>list</code>,</nobr> <nobr><code>tree</code>,</nobr> or <code>grid</code>
it will by definition typically not have interface controls and therefore no integrated tab-key-control.&nbsp;
With these other picker-types, you must develop your own keyboard control within
to manage the “required” <abbr>ARIA</abbr> keyboard support.&nbsp;
Every interface design will be unique, and the <code>Picker</code> class can not simply adapt,
nor do we want to place limits on your interface design.&nbsp;
But the <code>Picker</code> can still manage the “pop-up” and “pop-down” aspects of that for you.&nbsp;
These color-picker examples above would be better suited to being type “list” (instead of the type “dialog” that they are)
and as such there should be JavaScript<abbr tm>™</abbr> included that
allows the end-user to navigate through the list of colors using the arrow keys; but this is just a simple example.&nbsp;</p>

<p>As mentioned above, the <code>Picker</code> Class manages more complex situations
where the Picker <abbr>HTML</abbr> Interface needs to scroll (using a scroll-bar).&nbsp;
Older versions of the <code>Picker</code> for older browsers required any Elements of your picker’s <abbr>HTML</abbr>
that needed to scroll should be contained within a panel; the panels themselves could not scroll.&nbsp;
I believe this problem is remedied with newer browsers, but it is still unchecked…
The idea of the <code>Picker</code> Class is that when you click anywhere on the Picker <abbr>HTML</abbr> Interface,
“focus” is retained by the “data target” <code>&lt;input&gt;</code>, even if nothing is “picked.”&nbsp;
Click on the caption of the itybitColorPicker above (where it says “Colors”),
or anywhere on the yellow background of the song-picker below, as a demonstration of this principle.&nbsp;
The <code>Picker</code> was designed to be intrinsically
<a href='https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-modal' target='Mozilla'>non-modal</a>
and when your “data target” looses focus by the end-user
clicking anywhere outside the Picker’s panels or outside of the “data target”
or otherwise tabs-out (using the <kbd><span>Tab</span></kbd> key) of the “data target”,
The picker “pops down” (or “pops out”, or “ disappears ”, or otherwise simply becomes “inactive”,
depending on <em>your</em> <abbr>CSS</abbr>).</p>

<p>This was the trick in older browsers, because of limitations in the
<acronym>DOM</acronym>—JavaScript<abbr tm>™</abbr> bindings,
and the <nobr><code>Picker</code>’s</nobr> code-base was much larger and complex.&nbsp;
I pulled hair for a while when the original prototypes for the <code>Picker</code> code would work and then wouldn’t,
so I would modify the way the handlers interacted, and that would work and then not…&nbsp;
With newer <abbr>HTML5</abbr> browsers,
there are newer native features that allow JavaScript<abbr tm>™</abbr> to “know” more about what is going on.&nbsp;
The latest version of the Picker Class works only with these newer browsers.</p>

<h3 id='data_targets'>Data Targets</h3>
<p>As mentioned, the “data target” is the JavaScript<abbr tm>™</abbr> Object
that receives the value that the end-user “picks”
(typically a textual value, but there is no global limitation).&nbsp;
Typically, the “data target” will be an <abbr>HTML</abbr> form element,
and specifically <code>&lt;textarea&gt;</code>s, <code>&lt;select&gt;</code>s, and
<code>&lt;input&gt;</code>s with or without the <code>list='<var>datalistID</var>'</code> attribute are supported;&nbsp;
but as mentioned, <abbr>HTML</abbr> text-nodes are also supported natively.&nbsp;
<code>&lt;input&gt;</code>s may be <code>type='text'</code> or other types typically including
<code>color</code>, <code>email</code>, <code>number</code>, <code>password</code>, <code>search</code>, <code>tel</code>, &amp; <code>url</code>.&nbsp;
<code>&lt;input&gt;</code> types not listed above could also be used, but browsers typically supply a native widget,
or they don’t typically interface with humans in a “picker” sort of way;
note file-inputs will <strong>not</strong> allow a picker to change or access the complete file-path
in any way, so you can’t use the <code>Picker</code> class with them.&nbsp;
Most “data targets” get their <code>.value</code> property set with the picked-data;
<code>&lt;select&gt;</code>s and <code>&lt;input list='<var>datalistID</var>'&gt;</code>
have their “options-list” changed.&nbsp;
Data targets may be “additive” or not.&nbsp;
Additive data targets have the “picked data” added to the existing value or options-list;
whereas non-additive data targets have their values or an option replaced by the “picked data”.
Textual additive data targets may have the “picked data” added where the cursor is placed,
or if text is “selected” (highlighted) that section of text will be replaced with the “picked data”.
However, if the additive nature is specified as <code>end</code>, the “picked data” will
<strong>always</strong> be added to the end of the existing textual value.&nbsp;
If there is an “options list” with an “additive” element,
another “option” will be added to the end of the list (always at the end);
if the element is not “additive” the <em>selected</em> option’s old value will be replaced with the new “picked data”.&nbsp;
You can specify that a “data target” is additive (or not — the default anyway) when you register it:
<code><var>pickerInstance</var>.registerTargetElement(<var>input</var>, {additive:'end'});</code>
or by specifying such with an attribute:
<code>&lt;input type='text' additive&gt;</code>
noting that the <code>additive</code> attribute is <a href='#Boolean'>Boolean¹</a> in nature,
and indicates <code>true</code> when present without a value;
but could also be <code>='end'</code> or <code>='false'</code>.&nbsp;
Attribute values override the specs passed in when registering a target,
so you would only need <code>='false'</code> if you were "bulk processing"
a bunch of “data targets” and most of them were supposed to be additive.
</p>

<h3 id='interface_controls'>Interface Controls</h3>
<p>Your picker(s) themselves may need to adapt to the end-user’s demands,
and they do such using “interface controls” – form controls
(such as <code>&lt;input&gt;</code>s and <code>&lt;select&gt;</code>s)
that modify the “pickers” themselves and/or their behaviors.&nbsp;
Your interface controls may be in (on?) one of your panels or not
– that’s up to you and the design specs that work best for you.&nbsp;
If they are in a panel, you need not worry about them,
the <code>Picker</code> class takes care of all the details.&nbsp;
If they are free-range (somewhere else in your web-page),
you need to register them so the <code>Picker</code> class
knows to keep your picker active while the end-user interacts
with these “interface controls”
(assuming you <em>want</em> to keep it active – that is not strictly required, but usually nice for the end-user).&nbsp;
To do that, use:
<code><var>pickerInstance</var>.registerInterfaceControl(<var>input</var>)</code>
noting that <code><var>input</var></code> may be any element that accepts keyboard focus
(typically, <code>&lt;textarea&gt;</code>, <code>&lt;select&gt;</code>, <code>&lt;button&gt;</code>, as well as  <code>&lt;input&gt;</code>,
but also note you may customize any element to receive focus using the <code>tabindex</code> attribute).
</p>

<h3 id='interface_targets'>Interface Targets</h3>
<p>“Interface Targets” are special “interface controls” of your Picker
that can receive a value “picked” from another part of your Picker,
where normally a user “picks” something for the “data Target”.&nbsp;
For instance, the <a href='https://softmoon-webware.com/MasterColorPicker_instructions.php'>MasterColorPicker</a>
Version 2 project has a “color filter” that filters the color a user “picks” from one of the palettes,
modifying the “picked” color by mixing in the “filter-color”.&nbsp;
The user must first choose this filter-color, by picking a color from one of the palettes.&nbsp;
So the color-filter panel has an “interface Target” to receive the filter-color picked.&nbsp;
As usual, the Picker Class makes sure keyboard focus is directed to the proper Element at all times,
as well as properly managing the “top panel” under these shifting conditions.&nbsp;
An “interface control” in your panel may be designated as being an “interface target”
by giving it the <abbr>HTML</abbr> attribute <code>interfaceTarget='true'</code>
(note this is a “<a href='#Boolean'>Boolean¹</a>” attribute, and its presence without a value equates to "true");
or you can register it using <code><var>pickerInstance</var>.registerInterfaceControl(<var>input</var>, {interfaceTarget:true});</code>
(if it is on a picker-panel, register it before you register the panel).&nbsp;
Or when you register a picker-panel, you may specify that <strong>all</strong>
interface-controls within are interface-targets using
<code><var>pickerInstance</var>.registerInterfacePanel(<var>panel</var>, {interfaceTarget:true});</code>
and in this case, individual <nobr><code>&lt;input&gt;</code>s</nobr> (etc.) may have the attribute
<code>interfaceTarget='false'</code>.</p>

<h3 id='multipanel'>Multiple “panels” &amp; “pickers” with “dialog” type pickers</h3>
<p>If you want to use more that one “panel”
(<abbr>i.e.</abbr> more than the <code>mainPanel</code>,
which is passed in as the first (required) argument when creating a new <code>Picker</code> instance),
you need to “register” the additional panels,
the same as you need to “register” interface control-elements
(see above, and also the comments in the <code>Picker</code> code file).&nbsp;
Registering an additional panel (besides the <code>mainPanel</code>) also automatically
registers any “interface control-elements” within that panel.&nbsp;
If you want to use more than one “picker,” the <code>Picker</code> Class can manage that also,
provided all the “pickers” reside within these “registered”
<code><var>PickerInstance</var>.panels</code> (including the <code>mainPanel</code>).&nbsp;
The <code>options</code> Object that can be passed in as a
second argument when creating a new <code>Picker</code> instance
may hold a <code>pickerSelect</code> property that references either a <code>&lt;select&gt;</code> tag
or an array of <code>&lt;input type='checkbox‖radio'&gt;</code> buttons that can control which “Pickers”
are considered “active.”&nbsp;
You should also probably “register” your <code>pickerSelect</code>
if it is a <code>&lt;select&gt;</code> tag and not within a registered “panel”,
assuming you want to keep the “focus” of the target <code>&lt;input&gt;</code> while selecting different pickers.&nbsp;</p>

<h3 id='implementing_ARIA'><abbr title='Accessible Rich Internet Applications'>ARIA</abbr> support with multiple “panels”</h3>
<p>If you do choose to implement more than one picker-panel,
you need to inform your <code>Picker</code> instance
on how to handle the <abbr>ARIA</abbr>-support for pop-ups
(unless for some reason you don’t want <abbr>ARIA</abbr> supported).&nbsp;
When your picker is active, the “target input” is told what element “pops-up”
and this can then be made properly available to a screen reader, etc.&nbsp;
Typically, it is nice to have all the panels nested within this one containing “pop-up” element,
and this element should contain nothing else;
then when you create a new <code>Picker</code> instance,
pass in that containing element as the value for <code>opts.aria_popUp</code>.&nbsp;
The <a href="MasterColorPicker_instructions.php">MasterColorPicker</a> project uses that approach.&nbsp;
This is not always possible based on the <abbr>HTML</abbr> layout you need to implement.&nbsp;
When multiple picker-panels can not be nested within a single container,
the specified “aria-pop-up container” should use the <abbr>HTML</abbr> attribute <code>aria-owns</code>
to point to the free-range picker-panel(s), so the screen-reader can properly find and acknowledge them.&nbsp;
Alternatively, your “main-panel” may use <code>aria-owns</code> to point to the other “auxiliary” panels,
as does the example below.&nbsp;
If you only have the one single main-panel and you don’t pass in a value for <code>opts.aria_popUp</code>
then the main-panel automatically becomes the “popup dialog element”, as in the mini-color-picker example above.&nbsp;
If you don’t want the <code>Picker</code> to support <abbr>ARIA</abbr>,
simply pass in <code>opts.aria_popUp=null</code> when you create your <code>Picker</code> instance.&nbsp;
At any time after you create a picker, you can also modify <code><var>pickerInstance</var>.aria_popUp</code>
to whatever value you desire.&nbsp;
See <a href='#ARIA_logistics'>more about <abbr>ARIA</abbr></a> below.</p>

One final example (using the same <abbr>CSS</abbr> as those above, but with the addition shown below):
<code>
&#60;style&#62;
#songs .picker {
  display&#58; none; }
#songs .activePicker {
  display&#58; table; }
#songs {
  padding: 2em 0 .618em 0;
  margin: .618em 12.618em;
  position: relative; }
#songPickerControls.activePicker {
  position: absolute;
  top: 1.1618em;
  left: 0;
  display: block;
  width: 100%;
  text-align: center;
  background-color: yellow; }
#songs label {
  margin: 0 .618em; }
#songPickerHTML {
  background-color: yellow;
  border: 2px solid blue; }
&#60;/style&#62;

&#60;fieldset id='songs'&#62;&#60;legend&#62;Pick 3 songs&#60;/legend&#62;

&#60;label&#62;1. &#60;input type='text' role='combobox' aria-haspopup='dialog'&#62;&#60;/label&#62;
&#60;label&#62;2. &#60;input type='text' role='combobox' aria-haspopup='dialog'&#62;&#60;/label&#62;
&#60;label&#62;3. &#60;input type='text' role='combobox' aria-haspopup='dialog'&#62;&#60;/label&#62;

&#60;div id='songPickerHTML' role='dialog' aria-owns='songPickerControls'&#62;&#60;!-- this is the picker’s mainPanel --&#62;

&#60;table id='PinkFloyd' class='picker rock'&#62;&#60;caption&#62;Pink Floyd&#60;/caption&#62;
&#60;tr&#62;&#60;th&#62;song&#60;/th&#62;&#60;th&#62;from album&#60;/th&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Set the Controls for the Heart of the Sun&#60;/td&#62;&#60;td&#62;A Saucerful Of Secrets&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Main Theme&#60;/td&#62;&#60;td&#62;More&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Echoes&#60;/td&#62;&#60;td&#62;Meddle&#60;/td&#62;&#60;/tr&#62;
&#60;/table&#62;

&#60;table id='GratefulDead' class='picker rock'&#62;&#60;caption&#62;Grateful Dead&#60;/caption&#62;
&#60;tr&#62;&#60;th&#62;song&#60;/th&#62;&#60;th&#62;from album&#60;/th&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Bertha&#60;/td&#62;&#60;td&#62;Grateful Dead&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;China Cat Sunflower&#60;/td&#62;&#60;td&#62;Aoxomoxoa&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Eyes Of The World&#60;/td&#62;&#60;td&#62;Wake Of The Flood&#60;/td&#62;&#60;/tr&#62;
&#60;/table&#62;

&#60;table id='LedZeppelin' class='picker rock'&#62;&#60;caption&#62;Led Zeppelin&#60;/caption&#62;
&#60;tr&#62;&#60;th&#62;song&#60;/th&#62;&#60;th&#62;from album&#60;/th&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Whole Lotta Love&#60;/td&#62;&#60;td&#62;Led Zeppelin II&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Stairway to Heaven&#60;/td&#62;&#60;td&#62;Led Zeppelin IV&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;In The Light&#60;/td&#62;&#60;td&#62;Physical Graffiti&#60;/td&#62;&#60;/tr&#62;
&#60;/table&#62;

&#60;table id='MilesDavis' class='picker jazz'&#62;&#60;caption&#62;Miles Davis&#60;/caption&#62;
&#60;tr&#62;&#60;th&#62;song&#60;/th&#62;&#60;th&#62;from album&#60;/th&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Flamenco Sketches&#60;/td&#62;&#60;td&#62;Kind Of Blue&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;“Shhh”/“Peaceful”&#60;/td&#62;&#60;td&#62;In A Silent Way&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Pharaoh’s Dance&#60;/td&#62;&#60;td&#62;Bitches Brew&#60;/td&#62;&#60;/tr&#62;
&#60;/table&#62;

&#60;table id='TheloniusMonk' class='picker jazz'&#62;&#60;caption&#62;Thelonius Monk&#60;/caption&#62;
&#60;tr&#62;&#60;th&#62;song&#60;/th&#62;&#60;th&#62;from album&#60;/th&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Bright Mississippi&#60;/td&#62;&#60;td&#62;Monk’s Dream&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;I’m Confessin’ (That I Love You)&#60;/td&#62;&#60;td&#62;Solo Monk&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Ugly Beauty&#60;/td&#62;&#60;td&#62;Underground&#60;/td&#62;&#60;/tr&#62;
&#60;/table&#62;
&#60;table id='TedeschiTrucksBand' class='picker blues'&#62;&#60;caption&#62;Tedeschi Trucks Band&#60;/caption&#62;
&#60;tr&#62;&#60;th&#62;song&#60;/th&#62;&#60;th&#62;from album&#60;/th&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Don’t Let Me Slide&#60;/td&#62;&#60;td&#62;Revelator&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Love Has Something Else To Say&#60;/td&#62;&#60;td&#62;Revelator&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Learn How To Love&#60;/td&#62;&#60;td&#62;Everybody’s Talkin’&#60;/td&#62;&#60;/tr&#62;
&#60;/table&#62;

&#60;table id='PinkAnderson' class='picker blues'&#62;&#60;caption&#62;Pink Anderson&#60;/caption&#62;
&#60;tr&#62;&#60;th&#62;song&#60;/th&#62;&#60;th&#62;from album&#60;/th&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Papa’s About To Get Mad / Gonna Tip Out Tonight&#60;/td&#62;&#60;td&#62;(single)&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Every Day In The Week Blues / C.C And O. Blues&#60;/td&#62;&#60;td&#62;(single)&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Greasy Greens&#60;/td&#62;&#60;td&#62;American Street Songs&#60;/td&#62;&#60;/tr&#62;
&#60;/table&#62;

&#60;table id='FloydCouncil' class='picker blues'&#62;&#60;caption&#62;Floyd Council&#60;/caption&#62;
&#60;tr&#62;&#60;th&#62;song&#60;/th&#62;&#60;th&#62;from album&#60;/th&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;I Don’t Want No Hungry Woman&#60;/td&#62;&#60;td&#62;Carolina Blues&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Lookin’ For My Baby&#60;/td&#62;&#60;td&#62;Carolina Blues&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Workin Man Blues&#60;/td&#62;&#60;td&#62;Carolina Blues&#60;/td&#62;&#60;/tr&#62;
&#60;/table&#62;

&#60;/div&#62;&#60;!--  close  songPickerHTML  --&#62;

&#60;div id='songPickerControls' role='dialog'&#62;
&#60;label&#62;Style&#58; &#60;select id='musicStyle'&#62;
&#60;option selected='selected'&#62;rock&#60;/option&#62;
&#60;option&#62;jazz&#60;/option&#62;
&#60;option&#62;blues&#60;/option&#62;
&#60;/select&#62;&#60;/label&#62;
&#60;label&#62;Artist&#58; &#60;select id='artists'&#62;
&#60;option class='rock' selected='selected'&#62;Pink Floyd&#60;/option&#62;
&#60;option class='rock'&#62;Grateful Dead&#60;/option&#62;
&#60;option class='rock'&#62;Led Zeppelin&#60;/option&#62;
&#60;option class='jazz'&#62;Miles Davis&#60;/option&#62;
&#60;option class='jazz'&#62;Thelonius Monk&#60;/option&#62;
&#60;option class='blues'&#62;Tedeschi Trucks Band&#60;/option&#62;
&#60;option class='blues'&#62;Pink Anderson&#60;/option&#62;
&#60;option class='blues'&#62;Floyd Council&#60;/option&#62;
&#60;/select&#62;&#60;/label&#62;
&#60;/div&#62;

&#60;/fieldset&#62;

&#60;script type='text/javascript'&#62;
UniDOM.addEventHandler(window, 'onload', function() {
  var songsHTML=document.getElementById('songPickerHTML'),
      musicStyle=document.getElementById('musicStyle'),
      artistSelect=document.getElementById('artists'),
      sInputs=document.getElementById('songs').getElementsByTagName('input'),
      songs=songsHTML.getElementsByTagName('tr'),
      SongPicker=new SoftMoon.WebWare.Picker(songsHTML, {picker_select: artistSelect),
      selector=function() {SongPicker.pick(this.firstChild.data);},
      setStyle=function(onBoot) {
        for (var i=0, flag=false;  i&#60;artistSelect.options.length;  i++)  {
          artistSelect.options[i].disabled=!(this.value===artistSelect.options[i].className);
          if (!flag) artistSelect.options[i].selected=(flag=(this.value===artistSelect.options[i].className));   }
        if (onBoot!==true)  SongPicker.choosePicker();  };

  for (var i=0; i&#60;songs.length;  i++)  { //attach event handlers to each song in every table
    if (songs[i].firstChild.nodeName==='TD')  UniDOM.addEventHandler(songs[i].firstChild, 'onclick', selector);  }
  for (i=0; i&#60;sInputs.length;  i++)  {           // ↓↓note we pass in the &#60;label&#62; for each input as the containing element for the picker.
    SongPicker.registerTargetElement(sInputs[i], sInputs[i].parentNode);  }
  SongPicker.registerInterfacePanel(document.getElementById('songPickerControls'));
  UniDOM.addEventHandler(musicStyle, 'onchange', setStyle);
  setStyle.call(musicStyle, true);  });
&#60;/script&#62;
</code>
<fieldset id='songs'><legend>Pick 3 songs</legend>
<label>1. <input type='text' role='combobox' aria-hasopup='dialog'></label>
<label>2. <input type='text' role='combobox' aria-hasopup='dialog'></label>
<label>3. <input type='text' role='combobox' aria-hasopup='dialog'></label>
<div id='songPickerHTML' role='dialog' aria-owns='songPickerControls'>
<table id='PinkFloyd' class='picker rock'><caption>Pink Floyd</caption>
<tr><th>song</th><th>from album</th></tr>
<tr><td>Set the Controls for the Heart of the Sun</td><td>A Saucerful Of Secrets</td></tr>
<tr><td>Main Theme</td><td>More</td></tr>
<tr><td>Echoes</td><td>Meddle</td></tr>
</table>
<table id='GratefulDead' class='picker rock'><caption>Grateful Dead</caption>
<tr><th>song</th><th>from album</th></tr>
<tr><td>Bertha</td><td>Grateful Dead</td></tr>
<tr><td>China Cat Sunflower</td><td>Aoxomoxoa</td></tr>
<tr><td>Eyes Of The World</td><td>Wake Of The Flood</td></tr>
</table>
<table id='LedZeppelin' class='picker rock'><caption>Led Zeppelin</caption>
<tr><th>song</th><th>from album</th></tr>
<tr><td>Whole Lotta Love</td><td>Led Zeppelin II</td></tr>
<tr><td>Stairway to Heaven</td><td>Led Zeppelin IV</td></tr>
<tr><td>In The Light</td><td>Physical Graffiti</td></tr>
</table>
<table id='MilesDavis' class='picker jazz'><caption>Miles Davis</caption>
<tr><th>song</th><th>from album</th></tr>
<tr><td>Flamenco Sketches</td><td>Kind Of Blue</td></tr>
<tr><td>“Shhh”/“Peaceful”</td><td>In A Silent Way</td></tr>
<tr><td>Pharaoh’s Dance</td><td>Bitches Brew</td></tr>
</table>
<table id='TheloniusMonk' class='picker jazz'><caption>Thelonius Monk</caption>
<tr><th>song</th><th>from album</th></tr>
<tr><td>Bright Mississippi</td><td>Monk’s Dream</td></tr>
<tr><td>I’m Confessin’ (That I Love You)</td><td>Solo Monk</td></tr>
<tr><td>Ugly Beauty</td><td>Underground</td></tr>
</table>
<table id='TedeschiTrucksBand' class='picker blues'><caption>Tedeschi Trucks Band</caption>
<tr><th>song</th><th>from album</th></tr>
<tr><td>Don’t Let Me Slide</td><td>Revelator</td></tr>
<tr><td>Love Has Something Else To Say</td><td>Revelator</td></tr>
<tr><td>Learn How To Love</td><td>Everybody’s Talkin’</td></tr>
</table>
<table id='PinkAnderson' class='picker blues'><caption>Pink Anderson</caption>
<tr><th>song</th><th>from album</th></tr>
<tr><td>Papa’s About To Get Mad / Gonna Tip Out Tonight</td><td>(single)</td></tr>
<tr><td>Every Day In The Week Blues / C.C And O. Blues</td><td>(single)</td></tr>
<tr><td>Greasy Greens</td><td>American Street Songs</td></tr>
</table>
<table id='FloydCouncil' class='picker blues'><caption>Floyd Council</caption>
<tr><th>song</th><th>from album</th></tr>
<tr><td>I Don’t Want No Hungry Woman</td><td>Carolina Blues</td></tr>
<tr><td>Lookin’ For My Baby</td><td>Carolina Blues</td></tr>
<tr><td>Workin Man Blues</td><td>Carolina Blues</td></tr>
</table>
</div>
<div id='songPickerControls' role='dialog'>
<label>Style: <select id='musicStyle'>
<option selected='selected'>rock</option>
<option>jazz</option>
<option>blues</option>
</select></label>
<label>Artist: <select id='artists'>
<option class='rock' selected='selected'>Pink Floyd</option>
<option class='rock'>Grateful Dead</option>
<option class='rock'>Led Zeppelin</option>
<option class='jazz'>Miles Davis</option>
<option class='jazz'>Thelonius Monk</option>
<option class='blues'>Tedeschi Trucks Band</option>
<option class='blues'>Pink Anderson</option>
<option class='blues'>Floyd Council</option>
</select></label>
</div>
</fieldset>
<script type='text/javascript'>
UniDOM.addEventHandler(window, 'onload', function() {
	const
		songsHTML=document.getElementById('songPickerHTML'),
		musicStyle=document.getElementById('musicStyle'),
		artistSelect=document.getElementById('artists'),
		sInputs=document.getElementById('songs').getElementsByTagName('input'),
		songs=songsHTML.getElementsByTagName('tr'),
		SongPicker=new SoftMoon.WebWare.Picker(songsHTML, {picker_select: artistSelect}),
		selector=function() {SongPicker.pick(this.firstChild.data);},
		setStyle=function(onBoot) {
			for (var i=0, flag=false;  i<artistSelect.options.length;  i++)  {
				artistSelect.options[i].disabled=!(this.value===artistSelect.options[i].className);
				if (!flag) artistSelect.options[i].selected=(flag=(this.value===artistSelect.options[i].className));   }
			if (onBoot!==true)  SongPicker.choosePicker();  };

  for (var i=0; i<songs.length;  i++)  { //attach event handlers to each song in every table
	  if (songs[i].firstChild.nodeName==='TD')  UniDOM.addEventHandler(songs[i].firstChild, 'onclick', selector);  }
  for (i=0; i<sInputs.length;  i++)  {              // ↓↓note we pass in the <label> for each input as the containing element for the picker.
	  SongPicker.registerTargetElement(sInputs[i], sInputs[i].parentNode);  }
	SongPicker.registerInterfacePanel(document.getElementById('songPickerControls'));
	UniDOM.addEventHandler(musicStyle, 'onchange', setStyle);
	setStyle.call(musicStyle, true);  });
</script>
<p>The above example need not use two panels, and realistically complicates a simple interface.&nbsp;
But if you were to include items such as dates, publishers, playtimes, etc. into the tables in this example,
you may want to filter the possible song selections using any number of factors.&nbsp;
In a real-world shopping-cart project, having these filters in a separate panel from the “pickers,”
maybe even one that is always shown to the end-user,
can be an optimal way of organizing your <abbr>HTML</abbr> page.</p>

<h3 id='ARIA_logistics'><abbr title='Accessible Rich Internet Applications'>ARIA</abbr> support logistics</h3>
<p>Your picker-panel(s) do not need to
<a href='https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-haspopup' target="Mozilla">“pop-up” and “pop-down”</a>.&nbsp;
It/they may always be displayed to the user, if that is what you choose or need.&nbsp;
In that case, <a href='#implementing_ARIA'>as mentioned above</a>,
pass in <code>opts.aria_popUp=null</code> to the <code>Picker</code> constructor,
or set <code><var>pickerInstance</var>.aria_popUp=null</code> after you construct your picker.&nbsp;
If you <strong>do</strong> want you picker-panel(s) to “pop-up”
when the associated <code>&lt;input&gt;</code> (etc.) is active (has keyboard focus),
as <a href='#implementing_ARIA'>described above</a>, you need to tell your <code>Picker</code> instance
what the <abbr>HTML</abbr> pop-up element is by setting the
<nobr><code>Picker</code>’s</nobr> <code>.aria_popUp</code> value.&nbsp;
From there, the <code>Picker</code> class takes care of the dirty details.&nbsp;
The <code>Picker</code> supports basic rules of the <abbr>HTML</abbr> element
<a href='https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Roles/combobox_role' target="Mozilla">“combobox-role”</a>.&nbsp;
Your <code><var>pickerInstance</var>.aria_popUp</code> element
(remember, which may automatically be your <code>mainPanel</code> if it is the only one)
should by definition have a <code>role</code> attribute that describes what <strong><em>kind</em></strong> of
<a href='https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-haspopup' target="Mozilla">“pop-up”</a>
it is: menu, list, tree, grid, or dialog.&nbsp;
The picker recognizes this when your <code>Picker</code> is active,
and sets the <nobr><code>dataTarget &lt;input&gt;</code>’s</nobr> <code>aria-haspopup</code> attribute
properly according to the <code>role</code> attribute of your “pop-up”
(note: remember, other <abbr>HTML</abbr> <code>dataTarget</code> elements are also supported besides <code>&lt;input&gt;</code>).
It also properly sets the <code>dataTarget</code>’s <code>aria-controls</code> and <code>aria-expanded</code> attributes
when your <code>Picker</code> is active;
as such, your <code><var>pickerInstance</var>.aria_popUp</code> element
should (by definition) have an <code>id</code> attribute.&nbsp;
When your <code>Picker</code> becomes inactive, it removes these attributes from the <code>dataTarget</code>,
allowing another <code>&lt;input&gt;</code> (etc.) to become the <code>dataTarget</code> for your <code>Picker</code>.
It is up to you to supply any JavaScript<abbr tm>™</abbr> code to make the internals of
your picker-panels work according to <abbr>ARIA</abbr> rules for menus, lists, trees, or grids.&nbsp;
For <code>Picker</code>s with the <code>dialog</code> role,
this class supports the <kbd><span>Tab</span></kbd> key natively
for your “interface controls” that reside on the picker-panel(s),
and which integrates with the native “multi-panel” support by necessity:
</p>

<h3 id='tab_key'>The <kbd><span>Tab</span></kbd> key with “dialog” type Pickers</h3>
<p>With version 2+ of the Picker Class, the non-standard <abbr>HTML</abbr> attributes
“tabToTarget” (same as Version 1 release) and
“backTabToTarget” may have values of <code>"true"</code> or <code>"false"</code>;
these are “<a href='#Boolean'>Boolean¹</a>” attributes, and as such their simple inclusion without a value indicates a “true” value.&nbsp;
When registering an “interface panel” the first and last “interface controls” found on the panel
by default are registered to backtab-to-target and tab-to-target, respectively.&nbsp;
You can override this with the <abbr>HTML</abbr> attributes markup,
or with JavaScript<abbr tm>™</abbr> by “registering” them separately
with the desired options before registering the panel they are on (see the comments in the code-file).</p>

<p>For more complex tab-control needs, <abbr>HTML</abbr> of course gives you the <code>tabIndex</code>
attribute, but this can be confusing at best sometimes.&nbsp; If you are creating a plugin that should work within
any web-page, how can you be sure that your tab-indexes are not going to conflict with what the developer wants,
or with any other plugin?&nbsp;
Since registering an “interface control” interferes with the tab-key control by necessity,
I thought it best to fully integrate tab-key direction within this project for Version 2+, and enhanced that in Versions 5+.&nbsp;
This allows so much more flexibility and dynamicity in developing your Picker,
with multiple panels that may be added/removed and active/inactive according to needs (perhaps loaded via Ajax on demand).&nbsp;
So two more additional <abbr>HTML</abbr> attributes are now recognized by the Picker Class
for “registered interface controls”: “tabTo” and “backTabTo”.&nbsp;
They may have one of three value types.&nbsp;
Their values may be the <abbr>HTML</abbr> “id” of the Element to tab to, by preceding the “id” with a <code>#</code> symbol similar to <abbr>CSS</abbr> specs.&nbsp;
For example: <code>&lt;input tabTo='#myWebPageElement'&gt;</code>.&nbsp;
The <code>@</code> symbol may be used to signify one of several “special cases” that can not be simply pointed to or scripted.&nbsp;
These are <code>@next-panel</code>, <code>@previous-panel</code>, <code>@adjacent-panel</code>, and <code>@target</code>.&nbsp;
(see below for more about tabbing from one panel to another)&nbsp;
For example: <code>&lt;input tabTo='@next-panel'&gt;</code>.&nbsp;
The <code>@adjacent-panel</code> value relies on the <kbd><span>Shift</span></kbd> key being pressed to determine if the panel is the “next” or “previous” one.&nbsp;
If you only have two (2) panels, use this value.&nbsp;
The <code>@target</code> value works like the <code>tabToTarget</code> and <code>backTabToTarget</code> attributes noted above,
but it can not signify a <nobr>“<code>false</code>”</nobr> value like they can.&nbsp;
The value of a <nobr>“tabTo”</nobr> or <nobr>“backtabTo”</nobr> attribute may also be a
JavaScript<abbr tm>™</abbr> <em>expression</em> that evaluates to the Element to tab to.&nbsp;
The value of <nobr>“<code>this</code>”</nobr> within the expression is the “interface control” element that has keyboard focus;
you also have access within your expression to the values of the keydown <nobr>“<code>event</code>”</nobr>, the <nobr>“<code>PickerInstance</code>”</nobr>,
and the <nobr>“<code>actions</code>”</nobr> Object that you passed in when you <a href='#interface_controls'>registered the interface control</a>.&nbsp;
For example: <code>&lt;input tabTo='this.closest(".panel").querySelector(<br>
&nbsp;&nbsp;&nbsp;(event.shiftKey || actions.forceShiftKey) ^ PickerInstance.toggleShiftKeyAction ? ".coldButton" : ".hotButton")'&gt;</code></p>

<p>Users may also want to manually tab from one panel to another.&nbsp;
By default they could now do this using <kbd><span>CTRL</span>+<span>Tab</span></kbd>
and <kbd><span>SHIFT</span>+<span>CTRL</span>+<span>Tab</span></kbd>
except for that most browsers block these key-combos from JavaScript<abbr tm>™</abbr>.&nbsp;
So by default the Picker class <em>also</em> recognizes <kbd><span>CTRL</span>+<span>&lt;</span></kbd>
and <kbd><span>CTRL</span>+<span>&gt;</span></kbd>
(on <acronym>QUERTY</acronym> keyboards this would actually be
<kbd><span>SHIFT</span>+<span>CTRL</span>+<span>,&lt;</span></kbd> and
<kbd><span>SHIFT</span>+<span>CTRL</span>+<span>.&gt;</span></kbd>)
to serve this need.&nbsp;
On non-<acronym>QUERTY</acronym> keyboards, the <kbd><span>&lt;</span></kbd> and <kbd><span>&gt;</span></kbd> keys
may normally generate characters when pressed in combo with the <kbd><span>CTRL</span></kbd> key,
and the Picker’s default panel-tab control may then conflict (and not work!).&nbsp;
You may alter the values found in:
<code><var>pickerInstance</var>.panelTabKey</code> and <code><var>pickerInstance</var>.panelBacktabKey</code>
which are <code>UniDOM.KeySniffer</code> objects.&nbsp;
A value of <code>true</code> or <code>false</code> for a modifier-key means that key
<em>must</em> be in the indicated state.&nbsp;
A value of <code>undefined</code> for a modifier-key means the KeySniffer doesn’t care.</p>

<p>You may want your “interface control” to remain focused when it has focus
when the user presses the <kbd><span>&crarr;Enter</span></kbd> key;
or maybe you want keyboard focus to return to your data-target (<code>&lt;input&gt;</code>).&nbsp;
The Boolean value found at <code><var>pickerInstance</var>.doKeepInterfaceFocus</code>
controls that default action;
but your “interface control” itself may have an attribute <code>keep-focus</code>
and this may have a <a href='#Boolean'>Boolean¹</a> value that overrides the <code><var>pickerInstance</var></code> default.&nbsp;
For <abbr>HTML</abbr> <code>&lt;button&gt;</code> “interface controls”
the Picker also adds a customized <code>buttonpress</code> event
when the <code>&lt;button&gt;</code> has keyboard focus
and the user presses the <kbd><span>&crarr;Enter</span></kbd> key.</p>

<h4>notes</h4>
<dl>
	<dt id='Boolean'>1. Boolean attribute values</dt>
	<dd>The <code>Picker</code> uses the (nonstandard) <code>Boolean.eval()</code> function
	found in the <span class='filename'>JS_toolbucket/+++JS/+++.js</span> file.&nbsp;
	It recognizes more than simply <code>"true"</code> &amp; <code>"false"</code>.&nbsp;
	You can use any of the values it recognizes, including <code>"yes"</code> &amp; <code>"no"</code>.</dd>
</dl>

<!-- p>There are two <code>Picker</code> Class files included with the bundle:
<span class='filename'>JS_toolbox/SoftMoon-WebWare/Picker.js</span> and
<span class='filename'>JS_toolbox/SoftMoon-WebWare/Picker.withDebug.js</span>.&nbsp;
The debug feature can help you understand how the flow of events occur,
especially when developing Pickers with interface controls.&nbsp;
To use the debug feature (and only if you want to debug), you will need to include
<span class='filename'>JS_toolbox/Log.js</span> also.&nbsp;
Please see the comments in the <code>Picker</code> code file on using the log.</p  -->

</main>
<footer>
<p>SoftMoon-WebWare and its websites do not use or store “cookies” or other data on your computer/device
(except for application demos that require your intent to do so, to store “settings” and the data you generate and desire to save).&nbsp;
No personal data is transferred to any other entity
(except with your intent as previously stated while using “demos”,
and said data is only transferred to SoftMoon-WebWare.com and is <em>not</em> saved).&nbsp;
You are not being tracked, quantified, or mined for data when visiting our sites.&nbsp;
We hope you enjoy the advertisement-free experience that shuns the growing worldwide corporate-fascism movement.</p>
<p>All content found on this page &amp; site Copyright © 2010, 2012, 2013, 2022, 2023  by SoftMoon-WebWare and its owner,
all rights reserved, unless otherwise specifically noted.&nbsp;
Trademarks and Service-Marks are property of SoftMoon-WebWare and its owner,
all rights reserved, unless otherwise specifically noted.</p>
<p>
<note>“JavaScript” is a trademark of Oracle Corporation.</note>
</p>
</footer>
</body>
</html>
