<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name='description' content='SoftMoon-WebWare’s JavaScript™ powered input type="picker" HTML extension.' />
<meta name='author' content='Joe Golembieski, SoftMoon-WebWare' />
<meta name='copyright' content='Copyright © 2010, 2012, 2013, 2014, 2015 Joe Golembieski, SoftMoon-WebWare' />
<title>&lt;input type="picker"&gt; from SoftMoon-WebWare</title>
<script type='text/javascript' src='JS_toolbucket/SoftMoon-WebWare/UniDOM.js'></script>
<script type='text/javascript' src='JS_toolbucket/SoftMoon-WebWare/Picker.withDebug.js'></script>
<script type='text/javascript' src='JS_toolbucket/Log.js'></script><!--  only if you plan on logging to debug -->
<style type="text/css">
body, div, h1, h2, h4, img, li, menu, a, samp, pre, table, section {
	margin: 0;
	padding: 0; }
body {
	min-width: 800px;
	font-family: "Times", "Times New Roman", serif;
	color: #000000;
	background: #FFDEAD url(images/SoftMoon.repeat-y.png) repeat-y; }
#top {
	position: relative;
	height: 700px;
	min-height: 42em;
	background: #FFDEAD url(images/SoftMoon.repeat-x.png) repeat-x; }
#top, #content, footer {
	min-width: 62.618em;
	opacity: .62;
	-moz-opacity: .62;
	filter: alpha(opacity=62); }
#top h1:first-child {
	font-size: 1.618em;
	font-weight: bold;
	font-family: "Cooper Black", serif;
	padding: .618em 0 0 1em; }
#top h1 span {
	padding: 0 0 0 2.618em;
	font-size: .764em }  /* ≈ Φ + ((1-Φ) - (1-Φ)*Φ) */
#top h1:last-child {
	position: absolute;
	bottom: 17px;
	left: 0px;
	text-align: center;
	width: 100%; }
#top figure {
	position: absolute;
	top: 2.618em;
	left: 1em; }
#logo {
	font-size: 1.618em; /*for alt text*/
	font-weight: bold;
	line-height: 150%; }
#top figcaption {
	font-size: 1.382em;
	font-weight: bold;
	text-align: center;
	width: 27em; }
#top figcaption span {
	display: block;
	font-style: oblique; }
#top figcaption span em {
	text-transform: uppercase;
	font-weight: bold }
#content {
	width: 100%;  /* fix MS and IE: crash 'n' trash  (yet another "hasLayout" bug?) */
	background: #FFDEAD;
	text-align: center; }
#content > p {
	text-align: justify;
	text-indent: -.618em;
	font-size: 1.236em;
	width: 27em;
	margin: 0 auto 0 auto;
	padding: 0 1em 1em 1em; }
#content > p * {
	text-indent: 0; }
#content > p:first-letter {
	font-size: 1.618em;
	font-weight: bold;
	color: #000040; }

#content samp, code {
	white-space: nowrap;
	text-align: left;
	font-size: .854076em;
	font-family: "Consolas"; }
#content .example {
	width: 37em;
	font-size: 1.236em;
	text-align: left;
	margin: 0 auto 0 auto; }
p code {
  display: inline-block; }
#content > code, #content > samp {
	display: block;
	white-space: pre;
	background-color: white;
	width: auto; }
.filename {
  color: #0066FF;
	white-space: nowrap; }
label {
	display: inline-block;
	position: relative;
	margin-bottom: 4em; }
label .pickerPanel {
  position: absolute;
	top: 1.618em;
	right: -10.618em; }
.pickerPanel,
#songs .picker {display: none;}
.activePicker,
#songs .activePicker {display: table;}
#songs {
	padding: 2em 0 .618em 0;
	margin: .618em 12.618em;
	position: relative; }
#songPickerControls.activePicker {
	position: absolute;
	top: 1.1618em;
	left: 0;
	display: block;
	width: 100%;
	text-align: center;
	background-color: yellow; }
#songs label {
	margin: 0 .618em; }
#songPickerHTML {
	background-color: yellow;
	border: 2px solid blue; }
#songPickerHTML td {
	padding: 0 .618em;
	border: 1px solid;
	white-space: nowrap; }
#songPickerHTML td:last-child {
	font-style: oblique; }


footer {
	position: relative;
	height: 100px;
	background: #FFDEAD url(images/SoftMoon.footer.back.png) repeat-x bottom; }
footer p {
	position: absolute;
	left: 1.618em;
	bottom: .618em;
	font-size: .78em;
	font-weight: bold; }
footer .notice {
	white-space: nowrap;
	margin-right: 7.618em; }
mark.note,
.numerance {
	font-size: .618em;
	vertical-align: .618em;
	line-height: 100%; }
.macronym {
	display: inline;
	font-size: .763924em;
	vertical-align: .236076em;
	line-height: 100%; }
acronym.macronym {
	font-size: .382em;
	vertical-align: 1.1618em;
	border-bottom: none; }
mark {
	background-color: inherit; }
big {
	font-size: 1.618em;
	line-height: .5em; }
.title {
	text-decoration: underline; }
li .title {
	font-weight: bold; }
kbd span {
	display: inline-block;
	position: static;
	border: 1px solid #8080FF;
	border-bottom: 2px solid #404080;
	border-right: 2px solid #404080;
	border-radius: 1.618em / 2em;
	color: white;
	background-color: #202040;
	text-align: center;
	margin: 0 .382em;
	padding: 0 .618em;  }

</style>
<!--[if IE]>
<style type="text/css">
#top li { display: inline; }
</style>
<![endif]-->
</head>
<body>
<header id='top'>
<h1>Custom Web Software Development for the 21<mark class='numerance'>st</mark> Century<acronym class='macronym' title="service mark">SM</acronym></h1>
<figure>
<img id='logo' src="images/SoftMoon.gif" alt="SoftMoon WebWare" />
<figcaption><acronym>PHP</acronym>, <acronym>SQL</acronym>s, JavaScript<mark class='macronym'>™</mark>, <acronym>Ajax</acronym>, <acronym>HTML5</acronym>, <acronym>XHTML</acronym>, &amp; <acronym>CSS3</acronym>:
<span>Innovative Enterprise level Scripting for interactive sites, <acronym title='software as a service'>SaaS</acronym>, &amp; cross-platform desktop apps</span></figcaption>
</figure>
<h1>JavaScript<mark class='macronym'>™</mark> powered <code>&lt;input type="picker" /&gt;</code></h1>
</header>

<section id='content'>
<p><acronym>HTML</acronym> forms are an essential part of interacting with web-page viewers,
and the <code>&lt;input /&gt;</code> tag is the most common interface tool used.&nbsp;
However, it gives little help to users that need to enter complex and/or specific data.&nbsp;
<acronym>HTML5</acronym> introduces the <code>&lt;datalist&gt;</code> element which can turn an
<code>&lt;input /&gt;</code> tag into a hybrid with a <code>&lt;select&gt;</code> tag,
giving the user a pull-down menu to choose from without limiting the input data to only the menu items.&nbsp;
But sometimes that’s not enough…you want to present to your users
a complex table of data to choose from, or maybe some other source needs to generate the data on-the-fly,
such as a color-picker (like the MasterColorPicker project, for which this project was developed).&nbsp;
So here I present the <code>&lt;input type="picker" /&gt;</code> project.&nbsp;
If an <code>&lt;input type="text" /&gt;</code> tag is like a car,
and a <code>&lt;textarea&gt;</code> tag is like a pickup truck,
and a <code>&lt;select&gt;</code> tag is like a bus,
and an <code>&lt;input type="text" /&gt;</code> with a <code>&lt;datalist&gt;</code> is like a train,
then an <code>&lt;input /&gt;</code> with a <code>Picker</code> interface is like an multi-city intergalactic spacecraft.</p>

<p>Using the <code>Picker</code> Class with an <code>&lt;input type="text"&gt;</code> is simple.&nbsp;
Just as you would do using the <code>&lt;datalist&gt;</code> tag, the “picker” <acronym>HTML</acronym>
is separate from the <code>&lt;input /&gt;</code> tag itself.&nbsp;
However, <code>&lt;datalist&gt;</code>s are simple “lists”, and you may only associate one <code>&lt;datalist&gt;</code>
with each <code>&lt;input /&gt;</code>.&nbsp;
With the <code>Picker</code> Class you may associate any number of “panels” (<acronym>HTML</acronym> elements),
and each panel may have any number of “pickers” along with any other <acronym>HTML</acronym> markup
and auxiliary displays and data, as well as “interface” elements − form controls
(such as <code>&lt;input /&gt;</code>s and <code>&lt;select&gt;</code>s)
that modify the “pickers” themselves and/or their behaviors.&nbsp;
Furthermore, not only may you associate multiple “panels” and “pickers” with an <code>&lt;input /&gt;</code>,
you may associate multiple <code>&lt;input /&gt;</code>s with the same “panel”(s)/“picker”(s).&nbsp;
For instance, the <a href="MasterColorPicker_instructions.php">MasterColorPicker 2</a> project uses
7 “panels” and 12 “pickers” by default,
and the <a href="RainbowMaker%202.0/">Rainbow-Maker 2</a> project
associates the MasterColorPicker with many different <code>&lt;input /&gt;</code>s.</p>

<p>“Panels” and their “pickers” receive applied <acronym>CSS</acronym> class-names when “active”,
allowing the developer to pop-up and pop-out the picker <acronym>HTML</acronym> if desired,
or style it any way needed for complete flexibility.&nbsp;
“Panels” may be styled any way you choose using your custom <acronym>CSS</acronym>,
and if you have more than one panel, they may visually overlap on the display;&nbsp;
the <code>Picker</code> Class manages an additional set of class-names which allows you to manage the
Z-index level of each panel, so the last one clicked on may be “brought to the top.”&nbsp;
The target <code>&lt;input /&gt;</code> (or <code>&lt;textarea&gt;</code> but for simplicity we will just refer to inputs)
also needs to be kept in focus when you click on the Picker Interface “panel(s).”&nbsp;
Additionally, “panels” and “pickers” may be assigned user-defined event-handlers which are triggered
when they become “active” or “inactive” (<code>onPickerStateChange</code> and <code>onInterfaceStateChange</code>).&nbsp;
All this is managed by the Picker Class by a complex interaction − a dance − of event-handlers.&nbsp;
This is its primary function in life.&nbsp;
It would be easy to have a JavaScript function that
simply adds/replaces an <code>&lt;input /&gt;</code>’s <code>value</code> with anything when you click on whatever…&nbsp;
And it’s easy to keep up with which <code>&lt;input /&gt;</code> is the one of many
of which to replace the old value with a new value.&nbsp;
The trick is keeping up with when an <code>&lt;input /&gt;</code> is “active”, especially when Picker-interfaces
need to scroll or if they need to use another <acronym>HTML</acronym> element that requires keyboard “focus.”&nbsp;
Generally, when an <code>&lt;input /&gt;</code> is associated with a Picker-interface,
the <code>&lt;input /&gt;</code> and Picker are considered “active” when the <code>&lt;input /&gt;</code> has “focus.”&nbsp;
If your interface itself needs to have an <acronym>HTML</acronym> element that requires keyboard “focus”,
including other <code>&lt;input type='text' /&gt;</code>s,
<code>&lt;input type='file' /&gt;</code>s, <code>&lt;input type='number' /&gt;</code>s,
<code>&lt;textarea&gt;</code>s, <code>&lt;select&gt;</code>s, etc.,
then they need to be “registered.”&nbsp;
The <code>Picker</code> Class gives you all you need to manage all the event-handlers required to maintain the “focus”
of the target <code>&lt;input /&gt;</code> associated with a Picker-interface when necessary, and to keep track of
when the Picker-interface is “active”, and when it is not.&nbsp;
The comments in the code file explain all this.&nbsp;
</p>

<p>But wait!&nbsp;
You don’t even need to use an <code>&lt;input type='text' /&gt;</code> with the <code>Picker</code> Class.&nbsp;
<acronym>HTML</acronym> <code>&lt;textarea&gt;</code>s, <code>&lt;select&gt;</code>s,
<code>&lt;input type='text' list='<var>datalistID</var>' /&gt;</code>s,
and even document text-nodes are automatically recognized by the <code><var>Picker_instance</var>.pick()</code> method.&nbsp;
By default, the <code><var>Picker_instance</var>.dataTarget</code> receives the data-value picked by the end user.&nbsp;
If no <code>dataTarget</code> is set then the <code><var>Picker_instance</var>.masterTarget</code> is used, if any.&nbsp;
The <code>dataTarget</code> and <code>masterTarget</code> each may be any
JavaScript<mark class='macronym'>™</mark> Object.&nbsp;
Or they may be <code>&lt;input type='hidden'&gt;</code> if you don't care to show the user the picked value,
but want to send the value back to the server with a form-submittal.&nbsp;
To supplement this functionality, add a JavaScript<mark class='macronym'>™</mark> function to the
Array of <code><var>Picker_instance</var>.pickFilters</code>.&nbsp;
To replace this functionality, replace the <code><var>Picker_instance</var>.pick</code> method with your own function.</p>

<p>There is a plethora of comments embedded in the <code>Picker</code> JavaScript<mark class='macronym'>™</mark> code
which you should read if you want to use this package.&nbsp;
Beyond that, as usual a simple example does best to explain the usage of the <code>Picker</code> Class Object.&nbsp;
Below you will see the code for a simple <acronym>HTML</acronym> <code>Picker</code> example and the working demo
of this example code.&nbsp;
If you open your browser’s JavaScript<mark class='macronym'>™</mark> console,
you can see the “flow” of events as they happen.&nbsp;
The MasterColorPicker<span class='macronym'>™</span> project is a more complex example of
using the <code>Picker</code> package.&nbsp;
If you study the <span class='filename'>MasterColorPicker.js</span> file, you will see the
<code>x_ColorPicker</code> Class (found near the beginning of that file)
acts as an intermediary between the color-pickers and the <code>Picker</code> Class.&nbsp;
At the end of each color-picker’s code section you will see the event-handlers attached to each color-picker,
and how they interact with the <code>x_ColorPicker</code> class to “pick” colors;&nbsp;
and the YinYang NíHóng<span class='macronym'>™</span> Color Picker code shows an advanced example of
using the <code>onPickerStateChange</code> event.&nbsp;
At the end of the <span class='filename'>MasterColorPicker.js</span> file you will see how the
<code>MasterColorPicker</code> Object (which is used by the <code>x-ColorPicker</code> Class)
is created from an instance of the <code>Picker</code> Class,
an example of how the <code>pickFilter</code> works, and another example of using the <code>onPickerStateChange</code> event.</p>

All these examples below use the following simple <acronym>CSS</acronym>:
<code>
&#60;style&#62;
label {
  display&#58; inline-block&#59;
  position&#58; relative&#59;
  margin-bottom&#58; 4em&#59; }
label .pickerPanel {
  position&#58; absolute&#59;
  top&#58; 1.1618em&#59;
  right&#58; -10.618em&#59; }
.pickerPanel {display&#58; none&#59;}
.activePicker {display&#58; table&#59;}
&#60;/style&#62;
</code>

A <em>very</em> simple example:
<code>
&#60;label&#62;Pick a color &#60;input type='text' id='getColor' /&#62;
&#60;table id='colorPicker'&#62;
&#60;caption&#62;Colors&#60;/caption&#62;
&#60;tr&#62;
	&#60;td style='background-color&#58;red'&#62;red&#60;/td&#62;
	&#60;td style='background-color&#58;orange'&#62;orange&#60;/td&#62;
	&#60;td style='background-color&#58;yellow'&#62;yellow&#60;/td&#62;
	&#60;td style='background-color&#58;green'&#62;green&#60;/td&#62;
	&#60;td style='background-color&#58;cyan'&#62;cyan&#60;/td&#62;
	&#60;td style='background-color&#58;blue'&#62;blue&#60;/td&#62;
	&#60;td style='background-color&#58;violet'&#62;violet&#60;/td&#62;
	&#60;td style='background-color&#58;indigo'&#62;indigo&#60;/td&#62;
&#60;/tr&#62;
&#60;/table&#62;&#60;/label&#62;
&#60;script type='text/javascript'&#62;
  // note how you can use the required/included “UniDOM” package to add event handlers, or add them any other way.

UniDOM.addEventHandler(window, 'onload', function() {
  var itybitHTML=document.getElementById('colorPicker'),
      itybitColorPicker=new SoftMoon.WebWare.Picker(itybitHTML, {debugLogger: new SoftMoon.WebWare.Log}),  // no options needed, but we do pass a logger for your entertainment
      itybitColorInput=document.getElementById('getColor'),
      itybitColors=itybitHTML.getElementsByTagName('td'),
      selector=function() {itybitColorPicker.pick(this.firstChild.data);};

  for (var i=0&#59; i&#60;itybitColors.length&#59;  i++)  {
    UniDOM.addEventHandler(itybitColors[i], 'onclick', selector)&#59;  }
  itybitColorPicker.registerTargetElement(itybitColorInput)&#59;  })&#59;
&#60;/script&#62;
</code>
<label>Pick a color <input type='text' id='getColor' />
<table id='colorPicker' class='picker'>
<caption>Colors</caption>
<tr>
	<td style='background-color:red'>red</td>
	<td style='background-color:orange'>orange</td>
	<td style='background-color:yellow'>yellow</td>
	<td style='background-color:green'>green</td>
	<td style='background-color:cyan'>cyan</td>
	<td style='background-color:blue'>blue</td>
	<td style='background-color:violet'>violet</td>
	<td style='background-color:indigo'>indigo</td>
</tr>
</table></label>
<script type='text/javascript'>
UniDOM.addEventHandler(window, 'onload', function() {
  var itybitHTML=document.getElementById('colorPicker'),
      itybitColorPicker=new SoftMoon.WebWare.Picker(itybitHTML, {debugLogger: new SoftMoon.WebWare.Log}),  // no options needed, but we do pass a logger
      itybitColorInput=document.getElementById('getColor'),
      itybitColors=itybitHTML.getElementsByTagName('td'),
			selector=function() {itybitColorPicker.pick(this.firstChild.data);};

  for (var i=0; i<itybitColors.length;  i++)  {
	  UniDOM.addEventHandler(itybitColors[i], 'onclick', selector);  }
	itybitColorPicker.registerTargetElement(itybitColorInput);  });
</script>
<br />
<span>Basically the same, but with two different target-inputs, and a relocating Picker.&nbsp;
Note the difference in the way the <code>dataTarget &lt;input /&gt;</code>s are registered:</span>
<code>
&#60;div id='relocatableColorPicker'&#62;
&#60;label&#62;Foreground Color&#58;&#60;input type='text' /&#62;&#60;/label&#62;
&#60;label&#62;Background Color&#58;&#60;input type='text' /&#62;&#60;/label&#62;
&#60;/div&#62;
&#60;script type='text/javascript'&#62;
UniDOM.addEventHandler(window, 'onload', function() {
  var itybitHTML=document.getElementById('colorPicker').cloneNode(true),   // we might instead use &#147;removeNode&#148; but we keep the original because it is used in the previous example.
      itybitColorPicker=new SoftMoon.WebWare.Picker(itybitHTML, {debugLogger: new SoftMoon.WebWare.Log}),  // no options needed, but we do pass a logger for your entertainment
      cInputs=document.getElementById('relocatableColorPicker').getElementsByTagName('input'),
      itybitColors=itybitHTML.getElementsByTagName('td'),
      selector=function() {itybitColorPicker.pick(this.firstChild.data)&#59;}&#59;

  for (var i=0&#59; i&#60;itybitColors.length&#59;  i++)  {
    UniDOM.addEventHandler(itybitColors[i], 'onclick', selector)&#59;  }
  for (var i=0&#59; i&#60;cInputs.length&#59;  i++)  {            // ↓↓note we pass in the &lt;label&gt; for each input as the containing element for the picker.
    itybitColorPicker.registerTargetElement(cInputs[i], cInputs[i].parentNode)&#59;  }  })&#59;
&#60;/script&#62;
</code>
<div id='relocatableColorPicker'>
<label>Foreground Color:<input type='text' /></label>
<label>Background Color:<input type='text' /></label>
</div>
<script type='text/javascript'>
UniDOM.addEventHandler(window, 'onload', function() {
  var itybitHTML=document.getElementById('colorPicker').cloneNode(true),   // we might instead use “removeNode” but we keep the original because it is used in the previous example.
      itybitColorPicker=new SoftMoon.WebWare.Picker(itybitHTML, {debugLogger: new SoftMoon.WebWare.Log}),  // no options needed, but we do pass a logger
      cInputs=document.getElementById('relocatableColorPicker').getElementsByTagName('input'),
      itybitColors=itybitHTML.getElementsByTagName('td'),
			selector=function() {itybitColorPicker.pick(this.firstChild.data);};

  for (var i=0; i<itybitColors.length;  i++)  {
	  UniDOM.addEventHandler(itybitColors[i], 'onclick', selector);  }
  for (var i=0; i<cInputs.length;  i++)  {              // ↓↓note we pass in the <label> for each input as the containing element for the picker.
	  itybitColorPicker.registerTargetElement(cInputs[i], cInputs[i].parentNode);  }  });
</script>
<p>As mentioned above, the <code>Picker</code> Class manages more complex situations
where the Picker <acronym>HTML</acronym> Interface needs to scroll (using a scroll-bar).&nbsp;
This is the trick, because often times clicking on a scroll-bar does not
generate an <code>onclick</code> event.&nbsp;
Focus is taken away from the target <code>&lt;input /&gt;</code>, and it needs to be “refocused.”&nbsp;
The <code>Picker</code> Class needs to keep track of where the mouse is,
so when a scroll-bar is clicked on this situation can be remedied.&nbsp;
The idea of the <code>Picker</code> Class is that when you click anywhere on the Picker <acronym>HTML</acronym > Interface,
“focus” is retained by the target <code>&lt;input /&gt;</code>, even if nothing is “picked.”&nbsp;
Click on the caption of the itybitColorPicker above (where it says “Colors”),
or anywhere on the yellow background of the song-picker below, as a demonstration of this principle.&nbsp;
With newer <acronym>HTML5</acronym> browsers, multiple events and event-handlers have more of a “defined”
order of occurance, based (at least) on the order that handlers are registered.&nbsp;
The “dance of event-handlers” is by definition random in the old <acronym>DOM</acronym> standard.&nbsp;
Sometimes the “onclick” event for the Picker <acronym>HTML</acronym> comes before the
“onblur” event for the <code>&lt;input /&gt;</code>, sometimes the other way around.&nbsp;
If the “blur” occurs first, depending on your <acronym>CSS</acronym> rules of course, the Picker <acronym>HTML</acronym>
may be hidden before the “click” happens;
then the click does not register on the Picker, but rather on whatever is underneath.&nbsp;
The <code>Picker</code> Class remedies this by keeping track of when the mouse is hovering over a “Picker panel,”
and also when it is hovering over the first-of-kin children.&nbsp;
If it is over the “panel,” but not over any of the children, then it must be over the scroll-bar.&nbsp;
If a registered target <code>&lt;input /&gt;</code> looses focus,
it will automatically refocus when the mouse is hovering over said scroll-bars.&nbsp;
At this point it might be thought “why not simply refocus if the mouse is over the Picker panel in general?”&nbsp;
That then voids the “onclick” event; it simply then never occurs and nothing gets “picked” —
at least in some browsers under some conditions;&nbsp;
I pulled hair for a while when the original prototypes for the <code>Picker</code> code would work and then wouldn’t,
so I would modify the way the handlers interacted, and that would work and then not…&nbsp;
Anyway, the “onclick” event on a picker-panel then refocuses the <code>dataTarget &lt;input /&gt;</code>.</p>

<p>The requirement of this scroll-bar situation is like this:&nbsp;
If your Picker <acronym>HTML</acronym> Interface needs to scroll, the “panels” should manage the scrolling;
nothing contained within the panels should use a scroll-bar.&nbsp;
Also, all first-of-kin children within the “panels” should be block-level elements with no margins between these children.&nbsp;
However, I haven’t tried it, but you may be able to nest one panel inside another, with the inner panel able to scroll.&nbsp;</p>

<p>If you want to use more that one “panel”
(<abbr>i.e.</abbr> more than the <code>mainPanel</code>,
which is passed in as the first (required) argument when creating a new <code>Picker</code> instance),
you need to “register” the additional panels,
the same as you need to “register” interface control-elements
(see above, and also the comments in the <code>Picker</code> code file).&nbsp;
Registering an additional panel (besides the <code>mainPanel</code>) also automatically
registers any “interface control-elements” within that panel.&nbsp;
If you want to use more than one “picker,” the <code>Picker</code> Class can manage that also,
provided all the “pickers” reside within these “registered”
<code><var>PickerInstance</var>.panels</code> (including the <code>mainPanel</code>).&nbsp;
The <code>options</code> Object that can be passed in as a
second argument when creating a new <code>Picker</code> instance
may hold a <code>pickerSelect</code> property that references either a <code>&lt;select&gt;</code> tag
or an array of <code>&lt;input type='checkbox‖radio' /&gt;</code> buttons that can control which “Pickers”
are considered “active.”&nbsp;
You should also probably “register” your <code>pickerSelect</code> if it is a <code>&lt;select&gt;</code> tag,
assuming you want to keep the “focus” of the target <code>&lt;input /&gt;</code> while selecting different pickers.&nbsp;</p>

One final example (using the same <acronym>CSS</acronym> as those above, but with the addition shown below):
<code>
&#60;style&#62;
#songs .picker {
  display&#58; none&#59; }
#songs .activePicker {
  display&#58; table&#59; }
#songs {
  padding: 2em 0 .618em 0;
  margin: .618em 12.618em;
  position: relative; }
#songPickerControls.activePicker {
  position: absolute;
  top: 1.1618em;
  left: 0;
  display: block;
  width: 100%;
  text-align: center;
  background-color: yellow; }
#songs label {
  margin: 0 .618em; }
#songPickerHTML {
  background-color: yellow;
  border: 2px solid blue; }
&#60;/style&#62;

&#60;fieldset id='songs'&#62;&#60;legend&#62;Pick 3 songs&#60;/legend&#62;

&#60;label&#62;1. &#60;input type='text' /&#62;&#60;/label&#62;
&#60;label&#62;2. &#60;input type='text' /&#62;&#60;/label&#62;
&#60;label&#62;3. &#60;input type='text' /&#62;&#60;/label&#62;

&#60;div id='songPickerHTML'&#62;&#60;!-- this is the picker’s mainPanel --&#62;

&#60;table id='PinkFloyd' class='picker rock'&#62;&#60;caption&#62;Pink Floyd&#60;/caption&#62;
&#60;tr&#62;&#60;th&#62;song&#60;/th&#62;&#60;th&#62;from album&#60;/th&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Set the Controls for the Heart of the Sun&#60;/td&#62;&#60;td&#62;A Saucerful Of Secrets&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Main Theme&#60;/td&#62;&#60;td&#62;More&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Echoes&#60;/td&#62;&#60;td&#62;Meddle&#60;/td&#62;&#60;/tr&#62;
&#60;/table&#62;

&#60;table id='GratefulDead' class='picker rock'&#62;&#60;caption&#62;Grateful Dead&#60;/caption&#62;
&#60;tr&#62;&#60;th&#62;song&#60;/th&#62;&#60;th&#62;from album&#60;/th&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Bertha&#60;/td&#62;&#60;td&#62;Grateful Dead&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;China Cat Sunflower&#60;/td&#62;&#60;td&#62;Aoxomoxoa&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Eyes Of The World&#60;/td&#62;&#60;td&#62;Wake Of The Flood&#60;/td&#62;&#60;/tr&#62;
&#60;/table&#62;

&#60;table id='LedZeppelin' class='picker rock'&#62;&#60;caption&#62;Led Zeppelin&#60;/caption&#62;
&#60;tr&#62;&#60;th&#62;song&#60;/th&#62;&#60;th&#62;from album&#60;/th&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Whole Lotta Love&#60;/td&#62;&#60;td&#62;Led Zeppelin II&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Stairway to Heaven&#60;/td&#62;&#60;td&#62;Led Zeppelin IV&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;In The Light&#60;/td&#62;&#60;td&#62;Physical Graffiti&#60;/td&#62;&#60;/tr&#62;
&#60;/table&#62;

&#60;table id='MilesDavis' class='picker jazz'&#62;&#60;caption&#62;Miles Davis&#60;/caption&#62;
&#60;tr&#62;&#60;th&#62;song&#60;/th&#62;&#60;th&#62;from album&#60;/th&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Flamenco Sketches&#60;/td&#62;&#60;td&#62;Kind Of Blue&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;&#147;Shhh&#148;/&#147;Peaceful&#148;&#60;/td&#62;&#60;td&#62;In A Silent Way&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Pharaoh&#146;s Dance&#60;/td&#62;&#60;td&#62;Bitches Brew&#60;/td&#62;&#60;/tr&#62;
&#60;/table&#62;

&#60;table id='TheloniusMonk' class='picker jazz'&#62;&#60;caption&#62;Thelonius Monk&#60;/caption&#62;
&#60;tr&#62;&#60;th&#62;song&#60;/th&#62;&#60;th&#62;from album&#60;/th&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Bright Mississippi&#60;/td&#62;&#60;td&#62;Monk&#146;s Dream&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;I&#146;m Confessin&#146; (That I Love You)&#60;/td&#62;&#60;td&#62;Solo Monk&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Ugly Beauty&#60;/td&#62;&#60;td&#62;Underground&#60;/td&#62;&#60;/tr&#62;
&#60;/table&#62;
&#60;table id='TedeschiTrucksBand' class='picker blues'&#62;&#60;caption&#62;Tedeschi Trucks Band&#60;/caption&#62;
&#60;tr&#62;&#60;th&#62;song&#60;/th&#62;&#60;th&#62;from album&#60;/th&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Don&#146;t Let Me Slide&#60;/td&#62;&#60;td&#62;Revelator&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Love Has Something Else To Say&#60;/td&#62;&#60;td&#62;Revelator&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Learn How To Love&#60;/td&#62;&#60;td&#62;Everybody&#146;s Talkin&#146;&#60;/td&#62;&#60;/tr&#62;
&#60;/table&#62;

&#60;table id='PinkAnderson' class='picker blues'&#62;&#60;caption&#62;Pink Anderson&#60;/caption&#62;
&#60;tr&#62;&#60;th&#62;song&#60;/th&#62;&#60;th&#62;from album&#60;/th&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Papa&#146;s About To Get Mad / Gonna Tip Out Tonight&#60;/td&#62;&#60;td&#62;(single)&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Every Day In The Week Blues / C.C And O. Blues&#60;/td&#62;&#60;td&#62;(single)&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Greasy Greens&#60;/td&#62;&#60;td&#62;American Street Songs&#60;/td&#62;&#60;/tr&#62;
&#60;/table&#62;

&#60;table id='FloydCouncil' class='picker blues'&#62;&#60;caption&#62;Floyd Council&#60;/caption&#62;
&#60;tr&#62;&#60;th&#62;song&#60;/th&#62;&#60;th&#62;from album&#60;/th&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;I Don&#146;t Want No Hungry Woman&#60;/td&#62;&#60;td&#62;Carolina Blues&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Lookin&#146; For My Baby&#60;/td&#62;&#60;td&#62;Carolina Blues&#60;/td&#62;&#60;/tr&#62;
&#60;tr&#62;&#60;td&#62;Workin Man Blues&#60;/td&#62;&#60;td&#62;Carolina Blues&#60;/td&#62;&#60;/tr&#62;
&#60;/table&#62;

&#60;/div&#62;&#60;!--  close  songPickerHTML  --&#62;

&#60;div id='songPickerControls'&#62;
&#60;label&#62;Style&#58; &#60;select id='musicStyle'&#62;
&#60;option selected='selected'&#62;rock&#60;/option&#62;
&#60;option&#62;jazz&#60;/option&#62;
&#60;option&#62;blues&#60;/option&#62;
&#60;/select&#62;&#60;/label&#62;
&#60;label&#62;Artist&#58; &#60;select id='artists'&#62;
&#60;option class='rock' selected='selected'&#62;Pink Floyd&#60;/option&#62;
&#60;option class='rock'&#62;Grateful Dead&#60;/option&#62;
&#60;option class='rock'&#62;Led Zeppelin&#60;/option&#62;
&#60;option class='jazz'&#62;Miles Davis&#60;/option&#62;
&#60;option class='jazz'&#62;Thelonius Monk&#60;/option&#62;
&#60;option class='blues'&#62;Tedeschi Trucks Band&#60;/option&#62;
&#60;option class='blues'&#62;Pink Anderson&#60;/option&#62;
&#60;option class='blues'&#62;Floyd Council&#60;/option&#62;
&#60;/select&#62;&#60;/label&#62;
&#60;/div&#62;

&#60;/fieldset&#62;

&#60;script type='text/javascript'&#62;
UniDOM.addEventHandler(window, 'onload', function() {
  var songsHTML=document.getElementById('songPickerHTML'),
      musicStyle=document.getElementById('musicStyle'),
      artistSelect=document.getElementById('artists'),
      sInputs=document.getElementById('songs').getElementsByTagName('input'),
      songs=songsHTML.getElementsByTagName('tr'),
      SongPicker=new SoftMoon.WebWare.Picker(songsHTML, {picker_select&#58; artistSelect, debugLogger: new SoftMoon.WebWare.Log}),
      selector=function() {SongPicker.pick(this.firstChild.data)&#59;},
      setStyle=function(onBoot) {
        for (var i=0, flag=false&#59;  i&#60;artistSelect.options.length&#59;  i++)  {
          artistSelect.options[i].disabled=!(this.value===artistSelect.options[i].className)&#59;
          if (!flag) artistSelect.options[i].selected=(flag=(this.value===artistSelect.options[i].className))&#59;   }
        if (onBoot!==true)  SongPicker.choosePicker()&#59;  }&#59;

  for (var i=0&#59; i&#60;songs.length&#59;  i++)  { //attach event handlers to each song in every table
    if (songs[i].firstChild.nodeName==='TD')  UniDOM.addEventHandler(songs[i].firstChild, 'onclick', selector)&#59;  }
  for (i=0&#59; i&#60;sInputs.length&#59;  i++)  {           // ↓↓note we pass in the &#60;label&#62; for each input as the containing element for the picker.
    SongPicker.registerTargetElement(sInputs[i], sInputs[i].parentNode)&#59;  }
  SongPicker.registerInterfacePanel(document.getElementById('songPickerControls'))&#59;
  UniDOM.addEventHandler(musicStyle, 'onchange', setStyle)&#59;
  setStyle.call(musicStyle, true)&#59;  })&#59;
&#60;/script&#62;
</code>
<fieldset id='songs'><legend>Pick 3 songs</legend>
<label>1. <input type='text' /></label>
<label>2. <input type='text' /></label>
<label>3. <input type='text' /></label>
<div id='songPickerHTML'>
<table id='PinkFloyd' class='picker rock'><caption>Pink Floyd</caption>
<tr><th>song</th><th>from album</th></tr>
<tr><td>Set the Controls for the Heart of the Sun</td><td>A Saucerful Of Secrets</td></tr>
<tr><td>Main Theme</td><td>More</td></tr>
<tr><td>Echoes</td><td>Meddle</td></tr>
</table>
<table id='GratefulDead' class='picker rock'><caption>Grateful Dead</caption>
<tr><th>song</th><th>from album</th></tr>
<tr><td>Bertha</td><td>Grateful Dead</td></tr>
<tr><td>China Cat Sunflower</td><td>Aoxomoxoa</td></tr>
<tr><td>Eyes Of The World</td><td>Wake Of The Flood</td></tr>
</table>
<table id='LedZeppelin' class='picker rock'><caption>Led Zeppelin</caption>
<tr><th>song</th><th>from album</th></tr>
<tr><td>Whole Lotta Love</td><td>Led Zeppelin II</td></tr>
<tr><td>Stairway to Heaven</td><td>Led Zeppelin IV</td></tr>
<tr><td>In The Light</td><td>Physical Graffiti</td></tr>
</table>
<table id='MilesDavis' class='picker jazz'><caption>Miles Davis</caption>
<tr><th>song</th><th>from album</th></tr>
<tr><td>Flamenco Sketches</td><td>Kind Of Blue</td></tr>
<tr><td>“Shhh”/“Peaceful”</td><td>In A Silent Way</td></tr>
<tr><td>Pharaoh’s Dance</td><td>Bitches Brew</td></tr>
</table>
<table id='TheloniusMonk' class='picker jazz'><caption>Thelonius Monk</caption>
<tr><th>song</th><th>from album</th></tr>
<tr><td>Bright Mississippi</td><td>Monk’s Dream</td></tr>
<tr><td>I’m Confessin’ (That I Love You)</td><td>Solo Monk</td></tr>
<tr><td>Ugly Beauty</td><td>Underground</td></tr>
</table>
<table id='TedeschiTrucksBand' class='picker blues'><caption>Tedeschi Trucks Band</caption>
<tr><th>song</th><th>from album</th></tr>
<tr><td>Don’t Let Me Slide</td><td>Revelator</td></tr>
<tr><td>Love Has Something Else To Say</td><td>Revelator</td></tr>
<tr><td>Learn How To Love</td><td>Everybody’s Talkin’</td></tr>
</table>
<table id='PinkAnderson' class='picker blues'><caption>Pink Anderson</caption>
<tr><th>song</th><th>from album</th></tr>
<tr><td>Papa’s About To Get Mad / Gonna Tip Out Tonight</td><td>(single)</td></tr>
<tr><td>Every Day In The Week Blues / C.C And O. Blues</td><td>(single)</td></tr>
<tr><td>Greasy Greens</td><td>American Street Songs</td></tr>
</table>
<table id='FloydCouncil' class='picker blues'><caption>Floyd Council</caption>
<tr><th>song</th><th>from album</th></tr>
<tr><td>I Don’t Want No Hungry Woman</td><td>Carolina Blues</td></tr>
<tr><td>Lookin’ For My Baby</td><td>Carolina Blues</td></tr>
<tr><td>Workin Man Blues</td><td>Carolina Blues</td></tr>
</table>
</div>
<div id='songPickerControls'>
<label>Style: <select id='musicStyle'>
<option selected='selected'>rock</option>
<option>jazz</option>
<option>blues</option>
</select></label>
<label>Artist: <select id='artists'>
<option class='rock' selected='selected'>Pink Floyd</option>
<option class='rock'>Grateful Dead</option>
<option class='rock'>Led Zeppelin</option>
<option class='jazz'>Miles Davis</option>
<option class='jazz'>Thelonius Monk</option>
<option class='blues'>Tedeschi Trucks Band</option>
<option class='blues'>Pink Anderson</option>
<option class='blues'>Floyd Council</option>
</select></label>
</div>
</fieldset>
<script type='text/javascript'>
UniDOM.addEventHandler(window, 'onload', function() {
  var songsHTML=document.getElementById('songPickerHTML'),
			musicStyle=document.getElementById('musicStyle'),
      artistSelect=document.getElementById('artists'),
			sInputs=document.getElementById('songs').getElementsByTagName('input'),
      songs=songsHTML.getElementsByTagName('tr'),
      SongPicker=new SoftMoon.WebWare.Picker(songsHTML, {picker_select: artistSelect, debugLogger: new SoftMoon.WebWare.Log}),
			selector=function() {SongPicker.pick(this.firstChild.data);},
			setStyle=function(onBoot) {
			  for (var i=0, flag=false;  i<artistSelect.options.length;  i++)  {
					artistSelect.options[i].disabled=!(this.value===artistSelect.options[i].className);
					if (!flag) artistSelect.options[i].selected=(flag=(this.value===artistSelect.options[i].className));   }
				if (onBoot!==true)  SongPicker.choosePicker();  };

  for (var i=0; i<songs.length;  i++)  { //attach event handlers to each song in every table
	  if (songs[i].firstChild.nodeName==='TD')  UniDOM.addEventHandler(songs[i].firstChild, 'onclick', selector);  }
  for (i=0; i<sInputs.length;  i++)  {              // ↓↓note we pass in the <label> for each input as the containing element for the picker.
	  SongPicker.registerTargetElement(sInputs[i], sInputs[i].parentNode);  }
	SongPicker.registerInterfacePanel(document.getElementById('songPickerControls'));
	UniDOM.addEventHandler(musicStyle, 'onchange', setStyle);
	setStyle.call(musicStyle, true);  });
</script>
<p>The above example need not use two panels, and realistically complicates a simple interface.&nbsp;
But if you were to include items such as dates, publishers, playtimes, etc. into the tables in this example,
you may want to filter the possible song selections using any number of factors.&nbsp;
In a real-world shopping-cart project, having these filters in a separate panel from the “pickers,”
maybe even one that is always shown to the end-user,
can be an optimal way of organizing your <acronym>HTML</acronym> page.</p>

<p>The version 2 release of the Picker Class adds even better support for “interface Elements” in the
pickers you develop.&nbsp;  Tab-key support within interface Elements has been expanded,
and a new concept of “interface Targets” is now available for use.&nbsp;
Version 1 of the Picker Class gave you the ability to “tabToTarget” from an interface Element;
but there was a “logic bug” when you had multiple interface Elements on a panel:
normally the user would want to tab from one “interface Element” to the next,
and then from the last one to the <code><var>Picker_instance</var>.dataTarget</code>, so this last one would
get the “tabToTarget” attribute; but when the user back-tabs (<kbd><span>shift</span></kbd> <kbd><span>tab</span></kbd>),
the keyboard focus would be sent to the <code>dataTarget</code> also, instead of the previous “interface Element.”&nbsp;
Likewise, the user should be able to back-tab from the first “interface Element” on a panel to the <code>dataTarget</code>.</p>

<p>With version 2 of the Picker Class, the non-standard <acronym>HTML</acronym> attributes
“tabToTarget” (same as Version 1 release) and
“backTabToTarget” may have values of <code>"true"</code> or <code>"false"</code>.&nbsp;
When registering an “interface panel” the first and last “interface Elements” found on the panel
by default are registered to backtab-to-target and tab-to-target, respectively.&nbsp;
You can override this with the <acronym>HTML</acronym> attributes markup,
or with JavaScript<mark class='macronym'>™</mark> by “registering” them seperately
with the desired options before registering the panel they are on (see the comments in the code-file).</p>

<p>For more complex tab-control needs, <acronym>HTML</acronym> of course gives you the <code>tabIndex</code>
attribute, but this can be confusing at best sometimes.&nbsp; If you are creating a plugin that should work within
any web-page, how can you be sure that your tab-indexes are not going to conflict with what the develper wants,
or with any other plugin?&nbsp;
Since registering an “interface Element” interferes with the tab-key control by nessesity,
I thought it best to fully integrate tab-key direction within this project for Version 2.&nbsp;
This allows so much more flexibility and dynamicy in developing your Picker,
with multiple panels that may be added/removed according to needs (perhaps loaded via Ajax on demand).&nbsp;
So two more additional <acronym>HTML</acronym> attributes are now recognized by the Picker Class
for “registered interface Elements”: “tabTo” and “backTabTo”.&nbsp;
Their values may be either an <acronym>HTML</acronym> “id” of the Element to tab to,
or a JavaScript<mark class='macronym'>™</mark> expression that evaluates to the Element to tab to.</p>

<p>“Interface Targets” are special “interface Elements” of your Picker
that can receive a value “picked” from another part of your Picker,
where normally a user “picks” something for the “data Target”.&nbsp;
For instance, the <a href='http://softmoon-webware.com/MasterColorPicker_instructions.php'>MasterColorPicker</a>
Version 2 project has a “color filter” that filters the color a user “picks” from one of the palettes,
modifying the “picked” color by mixing in the “filter-color”.&nbsp;
The user must first choose this filter-color, by picking a color from one of the palettes.&nbsp;
So the color-filter panel has an “interface Target” to recieve the filter-color picked.&nbsp;
As usual, the Picker Class makes sure keyboard focus is directed to the proper Element at all times,
as well as properly managing the “top panel” under these shifting conditions.</p>



<p>There are two <code>Picker</code> Class files included with the bundle:
<span class='filename'>JS_toolbox/SoftMoon-WebWare/Picker.js</span> and
<span class='filename'>JS_toolbox/SoftMoon-WebWare/Picker.withDebug.js</span>.&nbsp;
The debug feature can help you understand how the flow of events occur,
expecially when developing Pickers with interface elements.&nbsp;
To use the debug feature (and only if you want to debug), you will need to include
<span class='filename'>JS_toolbox/Log.js</span> also.&nbsp;
Please see the comments in the <code>Picker</code> code file on using the log.</p>

</section>
<footer>
<p>All content found on this page &amp; site Copyright © 2010, 2012, 2013 by SoftMoon WebWare and its owner,
all rights reserved, unless otherwise specifically noted.&nbsp;
Trademarks and Service-Marks are property of SoftMoon WebWare and its owner,
all rights reserved, unless otherwise specifically noted.<br />

<span class='notice'>“JavaScript<mark class='macronym'>™</mark>” is a trademark of Sun Microsystems.</span></p>
</footer>
</body>
</html>
